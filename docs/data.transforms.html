---

title: Helper functions for processing data and basic transforms
keywords: fastai
sidebar: home_sidebar

summary: "Functions for getting, splitting, and labeling data, as well as generic transforms"
---
<!--

#################################################
### THIS FILE WAS AUTOGENERATED! DO NOT EDIT! ###
#################################################
# file to edit: nbs/05_data.transforms.ipynb
# command to build the docs after a change: nbdev_build_docs

-->

<div class="container" id="notebook-container">
    
<div class="cell border-box-sizing code_cell rendered">

</div>
<div class="cell border-box-sizing code_cell rendered">

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="kn">from</span> <span class="nn">nbdev.showdoc</span> <span class="k">import</span> <span class="o">*</span>
</pre></div>

    </div>
</div>
</div>

</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h2 id="Get,-split,-and-label">Get, split, and label<a class="anchor-link" href="#Get,-split,-and-label">&#182;</a></h2>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>For most data source creation we need functions to get a list of items, split them in to train/valid sets, and label them. fastai provides functions to make each of these steps easy (especially when combined with <code>fastai.data.blocks</code>).</p>

</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h3 id="Get">Get<a class="anchor-link" href="#Get">&#182;</a></h3>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>First we'll look at functions that <em>get</em> a list of items (generally file names).</p>
<p>We'll use <em>tiny MNIST</em> (a subset of MNIST with just two classes, <code>7</code>s and <code>3</code>s) for our examples/tests throughout this page.</p>

</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">path</span> <span class="o">=</span> <span class="n">untar_data</span><span class="p">(</span><span class="n">URLs</span><span class="o">.</span><span class="n">MNIST_TINY</span><span class="p">)</span>
<span class="p">(</span><span class="n">path</span><span class="o">/</span><span class="s1">&#39;train&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">ls</span><span class="p">()</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">



<div class="output_text output_subarea output_execute_result">
<pre>(#2) [/home/jhoward/.fastai/data/mnist_tiny/train/7,/home/jhoward/.fastai/data/mnist_tiny/train/3]</pre>
</div>

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">

</div>
<div class="cell border-box-sizing code_cell rendered">

</div>
<div class="cell border-box-sizing code_cell rendered">

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_markdown rendered_html output_subarea ">
<h4 id="get_files" class="doc_header"><code>get_files</code><a href="https://github.com/fastai/fastai2/tree/master/fastai2/data/transforms.py#L23" class="source_link" style="float:right">[source]</a></h4><blockquote><p><code>get_files</code>(<strong><code>path</code></strong>, <strong><code>extensions</code></strong>=<em><code>None</code></em>, <strong><code>recurse</code></strong>=<em><code>True</code></em>, <strong><code>folders</code></strong>=<em><code>None</code></em>)</p>
</blockquote>
<p>Get all the files in <code>path</code> with optional <code>extensions</code>, optionally with <code>recurse</code>, only in <code>folders</code>, if specified.</p>

</div>

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>This is the most general way to grab a bunch of file names from disk. If you pass <code>extensions</code> (including the <code>.</code>) then returned file names are filtered by that list. Only those files directly in <code>path</code> are included, unless you pass <code>recurse</code>, in which case all child folders are also searched recursively. <code>folders</code> is an optional list of directories to limit the search to.</p>

</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">t3</span> <span class="o">=</span> <span class="n">get_files</span><span class="p">(</span><span class="n">path</span><span class="o">/</span><span class="s1">&#39;train&#39;</span><span class="o">/</span><span class="s1">&#39;3&#39;</span><span class="p">,</span> <span class="n">extensions</span><span class="o">=</span><span class="s1">&#39;.png&#39;</span><span class="p">,</span> <span class="n">recurse</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
<span class="n">t7</span> <span class="o">=</span> <span class="n">get_files</span><span class="p">(</span><span class="n">path</span><span class="o">/</span><span class="s1">&#39;train&#39;</span><span class="o">/</span><span class="s1">&#39;7&#39;</span><span class="p">,</span> <span class="n">extensions</span><span class="o">=</span><span class="s1">&#39;.png&#39;</span><span class="p">,</span> <span class="n">recurse</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
<span class="n">t</span>  <span class="o">=</span> <span class="n">get_files</span><span class="p">(</span><span class="n">path</span><span class="o">/</span><span class="s1">&#39;train&#39;</span><span class="p">,</span> <span class="n">extensions</span><span class="o">=</span><span class="s1">&#39;.png&#39;</span><span class="p">,</span> <span class="n">recurse</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="n">test_eq</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">t</span><span class="p">),</span> <span class="nb">len</span><span class="p">(</span><span class="n">t3</span><span class="p">)</span><span class="o">+</span><span class="nb">len</span><span class="p">(</span><span class="n">t7</span><span class="p">))</span>
<span class="n">test_eq</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">get_files</span><span class="p">(</span><span class="n">path</span><span class="o">/</span><span class="s1">&#39;train&#39;</span><span class="o">/</span><span class="s1">&#39;3&#39;</span><span class="p">,</span> <span class="n">extensions</span><span class="o">=</span><span class="s1">&#39;.jpg&#39;</span><span class="p">,</span> <span class="n">recurse</span><span class="o">=</span><span class="kc">False</span><span class="p">)),</span><span class="mi">0</span><span class="p">)</span>
<span class="n">test_eq</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">t</span><span class="p">),</span> <span class="nb">len</span><span class="p">(</span><span class="n">get_files</span><span class="p">(</span><span class="n">path</span><span class="p">,</span> <span class="n">extensions</span><span class="o">=</span><span class="s1">&#39;.png&#39;</span><span class="p">,</span> <span class="n">recurse</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">folders</span><span class="o">=</span><span class="s1">&#39;train&#39;</span><span class="p">)))</span>
<span class="n">t</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">



<div class="output_text output_subarea output_execute_result">
<pre>(#709) [/home/jhoward/.fastai/data/mnist_tiny/train/7/723.png,/home/jhoward/.fastai/data/mnist_tiny/train/7/7446.png,/home/jhoward/.fastai/data/mnist_tiny/train/7/8566.png,/home/jhoward/.fastai/data/mnist_tiny/train/7/9200.png,/home/jhoward/.fastai/data/mnist_tiny/train/7/7085.png,/home/jhoward/.fastai/data/mnist_tiny/train/7/8665.png,/home/jhoward/.fastai/data/mnist_tiny/train/7/7348.png,/home/jhoward/.fastai/data/mnist_tiny/train/7/9283.png,/home/jhoward/.fastai/data/mnist_tiny/train/7/9854.png,/home/jhoward/.fastai/data/mnist_tiny/train/7/9548.png...]</pre>
</div>

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>It's often useful to be able to create functions with customized behavior. <code>fastai.data</code> generally uses functions named as CamelCase verbs ending in <code>er</code> to create these functions. <a href="data.transforms.html#FileGetter"><code>FileGetter</code></a> is a simple example of such a function creator.</p>

</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">

</div>
<div class="cell border-box-sizing code_cell rendered">

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_markdown rendered_html output_subarea ">
<h4 id="FileGetter" class="doc_header"><code>FileGetter</code><a href="https://github.com/fastai/fastai2/tree/master/fastai2/data/transforms.py#L41" class="source_link" style="float:right">[source]</a></h4><blockquote><p><code>FileGetter</code>(<strong><code>suf</code></strong>=<em><code>''</code></em>, <strong><code>extensions</code></strong>=<em><code>None</code></em>, <strong><code>recurse</code></strong>=<em><code>True</code></em>, <strong><code>folders</code></strong>=<em><code>None</code></em>)</p>
</blockquote>
<p>Create <a href="data.transforms.html#get_files"><code>get_files</code></a> partial function that searches path suffix <code>suf</code>, only in <code>folders</code>, if specified, and passes along args</p>

</div>

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">fpng</span> <span class="o">=</span> <span class="n">FileGetter</span><span class="p">(</span><span class="n">extensions</span><span class="o">=</span><span class="s1">&#39;.png&#39;</span><span class="p">,</span> <span class="n">recurse</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
<span class="n">test_eq</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">t7</span><span class="p">),</span> <span class="nb">len</span><span class="p">(</span><span class="n">fpng</span><span class="p">(</span><span class="n">path</span><span class="o">/</span><span class="s1">&#39;train&#39;</span><span class="o">/</span><span class="s1">&#39;7&#39;</span><span class="p">)))</span>
<span class="n">test_eq</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">t</span><span class="p">),</span> <span class="nb">len</span><span class="p">(</span><span class="n">fpng</span><span class="p">(</span><span class="n">path</span><span class="o">/</span><span class="s1">&#39;train&#39;</span><span class="p">,</span> <span class="n">recurse</span><span class="o">=</span><span class="kc">True</span><span class="p">)))</span>
<span class="n">fpng_r</span> <span class="o">=</span> <span class="n">FileGetter</span><span class="p">(</span><span class="n">extensions</span><span class="o">=</span><span class="s1">&#39;.png&#39;</span><span class="p">,</span> <span class="n">recurse</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="n">test_eq</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">t</span><span class="p">),</span> <span class="nb">len</span><span class="p">(</span><span class="n">fpng_r</span><span class="p">(</span><span class="n">path</span><span class="o">/</span><span class="s1">&#39;train&#39;</span><span class="p">)))</span>
</pre></div>

    </div>
</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">

</div>
<div class="cell border-box-sizing code_cell rendered">

</div>
<div class="cell border-box-sizing code_cell rendered">

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_markdown rendered_html output_subarea ">
<h4 id="get_image_files" class="doc_header"><code>get_image_files</code><a href="https://github.com/fastai/fastai2/tree/master/fastai2/data/transforms.py#L51" class="source_link" style="float:right">[source]</a></h4><blockquote><p><code>get_image_files</code>(<strong><code>path</code></strong>, <strong><code>recurse</code></strong>=<em><code>True</code></em>, <strong><code>folders</code></strong>=<em><code>None</code></em>)</p>
</blockquote>
<p>Get image files in <code>path</code> recursively, only in <code>folders</code>, if specified.</p>

</div>

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>This is simply <a href="data.transforms.html#get_files"><code>get_files</code></a> called with a list of standard image extensions.</p>

</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">test_eq</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">t</span><span class="p">),</span> <span class="nb">len</span><span class="p">(</span><span class="n">get_image_files</span><span class="p">(</span><span class="n">path</span><span class="p">,</span> <span class="n">recurse</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">folders</span><span class="o">=</span><span class="s1">&#39;train&#39;</span><span class="p">)))</span>
</pre></div>

    </div>
</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">

</div>
<div class="cell border-box-sizing code_cell rendered">

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_markdown rendered_html output_subarea ">
<h4 id="ImageGetter" class="doc_header"><code>ImageGetter</code><a href="https://github.com/fastai/fastai2/tree/master/fastai2/data/transforms.py#L56" class="source_link" style="float:right">[source]</a></h4><blockquote><p><code>ImageGetter</code>(<strong><code>suf</code></strong>=<em><code>''</code></em>, <strong><code>recurse</code></strong>=<em><code>True</code></em>, <strong><code>folders</code></strong>=<em><code>None</code></em>)</p>
</blockquote>
<p>Create <a href="data.transforms.html#get_image_files"><code>get_image_files</code></a> partial function that searches path suffix <code>suf</code> and passes along <code>kwargs</code>, only in <code>folders</code>, if specified.</p>

</div>

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>Same as <a href="data.transforms.html#FileGetter"><code>FileGetter</code></a>, but for image extensions.</p>

</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">test_eq</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">get_files</span><span class="p">(</span><span class="n">path</span><span class="o">/</span><span class="s1">&#39;train&#39;</span><span class="p">,</span> <span class="n">extensions</span><span class="o">=</span><span class="s1">&#39;.png&#39;</span><span class="p">,</span> <span class="n">recurse</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">folders</span><span class="o">=</span><span class="s1">&#39;3&#39;</span><span class="p">)),</span>
        <span class="nb">len</span><span class="p">(</span><span class="n">ImageGetter</span><span class="p">(</span>   <span class="s1">&#39;train&#39;</span><span class="p">,</span>                    <span class="n">recurse</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">folders</span><span class="o">=</span><span class="s1">&#39;3&#39;</span><span class="p">)(</span><span class="n">path</span><span class="p">)))</span>
</pre></div>

    </div>
</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">

</div>
<div class="cell border-box-sizing code_cell rendered">

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_markdown rendered_html output_subarea ">
<h4 id="get_text_files" class="doc_header"><code>get_text_files</code><a href="https://github.com/fastai/fastai2/tree/master/fastai2/data/transforms.py#L62" class="source_link" style="float:right">[source]</a></h4><blockquote><p><code>get_text_files</code>(<strong><code>path</code></strong>, <strong><code>recurse</code></strong>=<em><code>True</code></em>, <strong><code>folders</code></strong>=<em><code>None</code></em>)</p>
</blockquote>
<p>Get text files in <code>path</code> recursively, only in <code>folders</code>, if specified.</p>

</div>

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h3 id="Split">Split<a class="anchor-link" href="#Split">&#182;</a></h3>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>The next set of functions are used to <em>split</em> data into training and validation sets. The functions return two lists - a list of indices or masks for each of training and validation sets.</p>

</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">

</div>
<div class="cell border-box-sizing code_cell rendered">

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_markdown rendered_html output_subarea ">
<h4 id="RandomSplitter" class="doc_header"><code>RandomSplitter</code><a href="https://github.com/fastai/fastai2/tree/master/fastai2/data/transforms.py#L67" class="source_link" style="float:right">[source]</a></h4><blockquote><p><code>RandomSplitter</code>(<strong><code>valid_pct</code></strong>=<em><code>0.2</code></em>, <strong><code>seed</code></strong>=<em><code>None</code></em>, <strong>**<code>kwargs</code></strong>)</p>
</blockquote>
<p>Create function that splits <code>items</code> between train/val with <code>valid_pct</code> randomly.</p>

</div>

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">src</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="nb">range</span><span class="p">(</span><span class="mi">30</span><span class="p">))</span>
<span class="n">f</span> <span class="o">=</span> <span class="n">RandomSplitter</span><span class="p">(</span><span class="n">seed</span><span class="o">=</span><span class="mi">42</span><span class="p">)</span>
<span class="n">trn</span><span class="p">,</span><span class="n">val</span> <span class="o">=</span> <span class="n">f</span><span class="p">(</span><span class="n">src</span><span class="p">)</span>
<span class="k">assert</span> <span class="mi">0</span><span class="o">&lt;</span><span class="nb">len</span><span class="p">(</span><span class="n">trn</span><span class="p">)</span><span class="o">&lt;</span><span class="nb">len</span><span class="p">(</span><span class="n">src</span><span class="p">)</span>
<span class="k">assert</span> <span class="nb">all</span><span class="p">(</span><span class="n">o</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">val</span> <span class="k">for</span> <span class="n">o</span> <span class="ow">in</span> <span class="n">trn</span><span class="p">)</span>
<span class="n">test_eq</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">trn</span><span class="p">),</span> <span class="nb">len</span><span class="p">(</span><span class="n">src</span><span class="p">)</span><span class="o">-</span><span class="nb">len</span><span class="p">(</span><span class="n">val</span><span class="p">))</span>
<span class="c1"># test random seed consistency</span>
<span class="n">test_eq</span><span class="p">(</span><span class="n">f</span><span class="p">(</span><span class="n">src</span><span class="p">)[</span><span class="mi">0</span><span class="p">],</span> <span class="n">trn</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">

</div>
<div class="cell border-box-sizing code_cell rendered">

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_markdown rendered_html output_subarea ">
<h4 id="IndexSplitter" class="doc_header"><code>IndexSplitter</code><a href="https://github.com/fastai/fastai2/tree/master/fastai2/data/transforms.py#L77" class="source_link" style="float:right">[source]</a></h4><blockquote><p><code>IndexSplitter</code>(<strong><code>valid_idx</code></strong>)</p>
</blockquote>
<p>Split <code>items</code> so that <code>val_idx</code> are in the validation set and the others in the training set</p>

</div>

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">items</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="nb">range</span><span class="p">(</span><span class="mi">10</span><span class="p">))</span>
<span class="n">splitter</span> <span class="o">=</span> <span class="n">IndexSplitter</span><span class="p">([</span><span class="mi">3</span><span class="p">,</span><span class="mi">7</span><span class="p">,</span><span class="mi">9</span><span class="p">])</span>
<span class="n">test_eq</span><span class="p">(</span><span class="n">splitter</span><span class="p">(</span><span class="n">items</span><span class="p">),[[</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">4</span><span class="p">,</span><span class="mi">5</span><span class="p">,</span><span class="mi">6</span><span class="p">,</span><span class="mi">8</span><span class="p">],[</span><span class="mi">3</span><span class="p">,</span><span class="mi">7</span><span class="p">,</span><span class="mi">9</span><span class="p">]])</span>
</pre></div>

    </div>
</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">

</div>
<div class="cell border-box-sizing code_cell rendered">

</div>
<div class="cell border-box-sizing code_cell rendered">

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_markdown rendered_html output_subarea ">
<h4 id="GrandparentSplitter" class="doc_header"><code>GrandparentSplitter</code><a href="https://github.com/fastai/fastai2/tree/master/fastai2/data/transforms.py#L88" class="source_link" style="float:right">[source]</a></h4><blockquote><p><code>GrandparentSplitter</code>(<strong><code>train_name</code></strong>=<em><code>'train'</code></em>, <strong><code>valid_name</code></strong>=<em><code>'valid'</code></em>)</p>
</blockquote>
<p>Split <code>items</code> from the grand parent folder names (<code>train_name</code> and <code>valid_name</code>).</p>

</div>

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">fnames</span> <span class="o">=</span> <span class="p">[</span><span class="n">path</span><span class="o">/</span><span class="s1">&#39;train/3/9932.png&#39;</span><span class="p">,</span> <span class="n">path</span><span class="o">/</span><span class="s1">&#39;valid/7/7189.png&#39;</span><span class="p">,</span> 
          <span class="n">path</span><span class="o">/</span><span class="s1">&#39;valid/7/7320.png&#39;</span><span class="p">,</span> <span class="n">path</span><span class="o">/</span><span class="s1">&#39;train/7/9833.png&#39;</span><span class="p">,</span>  
          <span class="n">path</span><span class="o">/</span><span class="s1">&#39;train/3/7666.png&#39;</span><span class="p">,</span> <span class="n">path</span><span class="o">/</span><span class="s1">&#39;valid/3/925.png&#39;</span><span class="p">,</span>
          <span class="n">path</span><span class="o">/</span><span class="s1">&#39;train/7/724.png&#39;</span><span class="p">,</span> <span class="n">path</span><span class="o">/</span><span class="s1">&#39;valid/3/93055.png&#39;</span><span class="p">]</span>
<span class="n">splitter</span> <span class="o">=</span> <span class="n">GrandparentSplitter</span><span class="p">()</span>
<span class="n">test_eq</span><span class="p">(</span><span class="n">splitter</span><span class="p">(</span><span class="n">fnames</span><span class="p">),[[</span><span class="mi">0</span><span class="p">,</span><span class="mi">3</span><span class="p">,</span><span class="mi">4</span><span class="p">,</span><span class="mi">6</span><span class="p">],[</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">5</span><span class="p">,</span><span class="mi">7</span><span class="p">]])</span>
</pre></div>

    </div>
</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">

</div>
<div class="cell border-box-sizing code_cell rendered">

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_markdown rendered_html output_subarea ">
<h4 id="FuncSplitter" class="doc_header"><code>FuncSplitter</code><a href="https://github.com/fastai/fastai2/tree/master/fastai2/data/transforms.py#L95" class="source_link" style="float:right">[source]</a></h4><blockquote><p><code>FuncSplitter</code>(<strong><code>func</code></strong>)</p>
</blockquote>
<p>Split <code>items</code> by result of <code>func</code> (<code>True</code> for validation, <code>False</code> for training set).</p>

</div>

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">splitter</span> <span class="o">=</span> <span class="n">FuncSplitter</span><span class="p">(</span><span class="k">lambda</span> <span class="n">o</span><span class="p">:</span> <span class="n">Path</span><span class="p">(</span><span class="n">o</span><span class="p">)</span><span class="o">.</span><span class="n">parent</span><span class="o">.</span><span class="n">parent</span><span class="o">.</span><span class="n">name</span> <span class="o">==</span> <span class="s1">&#39;valid&#39;</span><span class="p">)</span>
<span class="n">test_eq</span><span class="p">(</span><span class="n">splitter</span><span class="p">(</span><span class="n">fnames</span><span class="p">),[[</span><span class="mi">0</span><span class="p">,</span><span class="mi">3</span><span class="p">,</span><span class="mi">4</span><span class="p">,</span><span class="mi">6</span><span class="p">],[</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">5</span><span class="p">,</span><span class="mi">7</span><span class="p">]])</span>
</pre></div>

    </div>
</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">

</div>
<div class="cell border-box-sizing code_cell rendered">

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_markdown rendered_html output_subarea ">
<h4 id="MaskSplitter" class="doc_header"><code>MaskSplitter</code><a href="https://github.com/fastai/fastai2/tree/master/fastai2/data/transforms.py#L103" class="source_link" style="float:right">[source]</a></h4><blockquote><p><code>MaskSplitter</code>(<strong><code>mask</code></strong>)</p>
</blockquote>
<p>Split <code>items</code> depending on the value of <code>mask</code>.</p>

</div>

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">items</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="nb">range</span><span class="p">(</span><span class="mi">6</span><span class="p">))</span>
<span class="n">splitter</span> <span class="o">=</span> <span class="n">MaskSplitter</span><span class="p">([</span><span class="kc">True</span><span class="p">,</span><span class="kc">False</span><span class="p">,</span><span class="kc">False</span><span class="p">,</span><span class="kc">True</span><span class="p">,</span><span class="kc">False</span><span class="p">,</span><span class="kc">True</span><span class="p">])</span>
<span class="n">test_eq</span><span class="p">(</span><span class="n">splitter</span><span class="p">(</span><span class="n">items</span><span class="p">),[[</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">4</span><span class="p">],[</span><span class="mi">0</span><span class="p">,</span><span class="mi">3</span><span class="p">,</span><span class="mi">5</span><span class="p">]])</span>
</pre></div>

    </div>
</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">

</div>
<div class="cell border-box-sizing code_cell rendered">

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_markdown rendered_html output_subarea ">
<h4 id="FileSplitter" class="doc_header"><code>FileSplitter</code><a href="https://github.com/fastai/fastai2/tree/master/fastai2/data/transforms.py#L109" class="source_link" style="float:right">[source]</a></h4><blockquote><p><code>FileSplitter</code>(<strong><code>fname</code></strong>)</p>
</blockquote>
<p>Split <code>items</code> depending on the value of <code>mask</code>.</p>

</div>

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="k">with</span> <span class="n">tempfile</span><span class="o">.</span><span class="n">TemporaryDirectory</span><span class="p">()</span> <span class="k">as</span> <span class="n">d</span><span class="p">:</span>
    <span class="n">fname</span> <span class="o">=</span> <span class="n">Path</span><span class="p">(</span><span class="n">d</span><span class="p">)</span><span class="o">/</span><span class="s1">&#39;valid.txt&#39;</span>
    <span class="n">fname</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s1">&#39;</span><span class="se">\n</span><span class="s1">&#39;</span><span class="o">.</span><span class="n">join</span><span class="p">([</span><span class="n">Path</span><span class="p">(</span><span class="n">fnames</span><span class="p">[</span><span class="n">i</span><span class="p">])</span><span class="o">.</span><span class="n">name</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span><span class="mi">3</span><span class="p">,</span><span class="mi">4</span><span class="p">]]))</span>
    <span class="n">splitter</span> <span class="o">=</span> <span class="n">FileSplitter</span><span class="p">(</span><span class="n">fname</span><span class="p">)</span>
    <span class="n">test_eq</span><span class="p">(</span><span class="n">splitter</span><span class="p">(</span><span class="n">fnames</span><span class="p">),[[</span><span class="mi">0</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">5</span><span class="p">,</span><span class="mi">6</span><span class="p">,</span><span class="mi">7</span><span class="p">],[</span><span class="mi">1</span><span class="p">,</span><span class="mi">3</span><span class="p">,</span><span class="mi">4</span><span class="p">]])</span>
</pre></div>

    </div>
</div>
</div>

</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h3 id="Label">Label<a class="anchor-link" href="#Label">&#182;</a></h3>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>The final set of functions is used to <em>label</em> a single item of data.</p>

</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">

</div>
<div class="cell border-box-sizing code_cell rendered">

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_markdown rendered_html output_subarea ">
<h4 id="parent_label" class="doc_header"><code>parent_label</code><a href="https://github.com/fastai/fastai2/tree/master/fastai2/data/transforms.py#L117" class="source_link" style="float:right">[source]</a></h4><blockquote><p><code>parent_label</code>(<strong><code>o</code></strong>, <strong>**<code>kwargs</code></strong>)</p>
</blockquote>
<p>Label <code>item</code> with the parent folder name.</p>

</div>

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>Note that <a href="data.transforms.html#parent_label"><code>parent_label</code></a> doesn't have anything customize, so it doesn't return a function - you can just use it directly.</p>

</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">test_eq</span><span class="p">(</span><span class="n">parent_label</span><span class="p">(</span><span class="n">fnames</span><span class="p">[</span><span class="mi">0</span><span class="p">]),</span> <span class="s1">&#39;3&#39;</span><span class="p">)</span>
<span class="n">test_eq</span><span class="p">(</span><span class="n">parent_label</span><span class="p">(</span><span class="s2">&quot;fastai_dev/dev/data/mnist_tiny/train/3/9932.png&quot;</span><span class="p">),</span> <span class="s1">&#39;3&#39;</span><span class="p">)</span>
<span class="p">[</span><span class="n">parent_label</span><span class="p">(</span><span class="n">o</span><span class="p">)</span> <span class="k">for</span> <span class="n">o</span> <span class="ow">in</span> <span class="n">fnames</span><span class="p">]</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">



<div class="output_text output_subarea output_execute_result">
<pre>[&#39;3&#39;, &#39;7&#39;, &#39;7&#39;, &#39;7&#39;, &#39;3&#39;, &#39;3&#39;, &#39;7&#39;, &#39;3&#39;]</pre>
</div>

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">

</div>
<div class="cell border-box-sizing code_cell rendered">

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_markdown rendered_html output_subarea ">
<h2 id="RegexLabeller" class="doc_header"><code>class</code> <code>RegexLabeller</code><a href="https://github.com/fastai/fastai2/tree/master/fastai2/data/transforms.py#L122" class="source_link" style="float:right">[source]</a></h2><blockquote><p><code>RegexLabeller</code>(<strong><code>pat</code></strong>)</p>
</blockquote>
<p>Label <code>item</code> with regex <code>pat</code>.</p>

</div>

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p><a href="data.transforms.html#RegexLabeller"><code>RegexLabeller</code></a> is a very flexible function since it handles any regex search of the stringified item. For instance, here's an example the replicates the previous <a href="data.transforms.html#parent_label"><code>parent_label</code></a> results.</p>

</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">regexp</span> <span class="o">=</span> <span class="n">re</span><span class="o">.</span><span class="n">compile</span><span class="p">(</span><span class="n">f</span><span class="s1">&#39;{re.escape(os.path.sep)}(\d){re.escape(os.path.sep)}&#39;</span><span class="p">)</span>
<span class="n">f</span> <span class="o">=</span> <span class="n">RegexLabeller</span><span class="p">(</span><span class="n">regexp</span><span class="p">)</span>
<span class="n">test_eq</span><span class="p">(</span><span class="n">parent_label</span><span class="p">(</span><span class="n">fnames</span><span class="p">[</span><span class="mi">0</span><span class="p">]),</span> <span class="s1">&#39;3&#39;</span><span class="p">)</span>
<span class="p">[</span><span class="n">f</span><span class="p">(</span><span class="n">o</span><span class="p">)</span> <span class="k">for</span> <span class="n">o</span> <span class="ow">in</span> <span class="n">fnames</span><span class="p">]</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">



<div class="output_text output_subarea output_execute_result">
<pre>[&#39;3&#39;, &#39;7&#39;, &#39;7&#39;, &#39;7&#39;, &#39;3&#39;, &#39;3&#39;, &#39;7&#39;, &#39;3&#39;]</pre>
</div>

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">

</div>
<div class="cell border-box-sizing code_cell rendered">

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_markdown rendered_html output_subarea ">
<h2 id="ColReader" class="doc_header"><code>class</code> <code>ColReader</code><a href="https://github.com/fastai/fastai2/tree/master/fastai2/data/transforms.py#L132" class="source_link" style="float:right">[source]</a></h2><blockquote><p><code>ColReader</code>(<strong><code>cols</code></strong>, <strong><code>pref</code></strong>=<em><code>''</code></em>, <strong><code>suff</code></strong>=<em><code>''</code></em>, <strong><code>label_delim</code></strong>=<em><code>None</code></em>)</p>
</blockquote>
<p>Read <code>cols</code> in <code>row</code> with potnetial <code>pref</code> and <code>suff</code></p>

</div>

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p><code>cols</code> can be a list of column names or a list of indices (or a mix of both). If <code>label_delim</code> is passed, the result is split using it.</p>

</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">({</span><span class="s1">&#39;a&#39;</span><span class="p">:</span> <span class="s1">&#39;a b c d&#39;</span><span class="o">.</span><span class="n">split</span><span class="p">(),</span> <span class="s1">&#39;b&#39;</span><span class="p">:</span> <span class="p">[</span><span class="s1">&#39;1 2&#39;</span><span class="p">,</span> <span class="s1">&#39;0&#39;</span><span class="p">,</span> <span class="s1">&#39;&#39;</span><span class="p">,</span> <span class="s1">&#39;1 2 3&#39;</span><span class="p">]})</span>
<span class="n">f</span> <span class="o">=</span> <span class="n">ColReader</span><span class="p">(</span><span class="s1">&#39;a&#39;</span><span class="p">,</span> <span class="n">pref</span><span class="o">=</span><span class="s1">&#39;0&#39;</span><span class="p">,</span> <span class="n">suff</span><span class="o">=</span><span class="s1">&#39;1&#39;</span><span class="p">)</span>
<span class="n">test_eq</span><span class="p">([</span><span class="n">f</span><span class="p">(</span><span class="n">o</span><span class="p">)</span> <span class="k">for</span> <span class="n">o</span> <span class="ow">in</span> <span class="n">df</span><span class="o">.</span><span class="n">itertuples</span><span class="p">()],</span> <span class="s1">&#39;0a1 0b1 0c1 0d1&#39;</span><span class="o">.</span><span class="n">split</span><span class="p">())</span>

<span class="n">f</span> <span class="o">=</span> <span class="n">ColReader</span><span class="p">(</span><span class="s1">&#39;b&#39;</span><span class="p">,</span> <span class="n">label_delim</span><span class="o">=</span><span class="s1">&#39; &#39;</span><span class="p">)</span>
<span class="n">test_eq</span><span class="p">([</span><span class="n">f</span><span class="p">(</span><span class="n">o</span><span class="p">)</span> <span class="k">for</span> <span class="n">o</span> <span class="ow">in</span> <span class="n">df</span><span class="o">.</span><span class="n">itertuples</span><span class="p">()],</span> <span class="p">[[</span><span class="s1">&#39;1&#39;</span><span class="p">,</span> <span class="s1">&#39;2&#39;</span><span class="p">],</span> <span class="p">[</span><span class="s1">&#39;0&#39;</span><span class="p">],</span> <span class="p">[],</span> <span class="p">[</span><span class="s1">&#39;1&#39;</span><span class="p">,</span> <span class="s1">&#39;2&#39;</span><span class="p">,</span> <span class="s1">&#39;3&#39;</span><span class="p">]])</span>

<span class="n">df</span><span class="p">[</span><span class="s1">&#39;a1&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">df</span><span class="p">[</span><span class="s1">&#39;a&#39;</span><span class="p">]</span>
<span class="n">f</span> <span class="o">=</span> <span class="n">ColReader</span><span class="p">([</span><span class="s1">&#39;a&#39;</span><span class="p">,</span> <span class="s1">&#39;a1&#39;</span><span class="p">],</span> <span class="n">pref</span><span class="o">=</span><span class="s1">&#39;0&#39;</span><span class="p">,</span> <span class="n">suff</span><span class="o">=</span><span class="s1">&#39;1&#39;</span><span class="p">)</span>
<span class="n">test_eq</span><span class="p">([</span><span class="n">f</span><span class="p">(</span><span class="n">o</span><span class="p">)</span> <span class="k">for</span> <span class="n">o</span> <span class="ow">in</span> <span class="n">df</span><span class="o">.</span><span class="n">itertuples</span><span class="p">()],</span> <span class="p">[(</span><span class="s1">&#39;0a1&#39;</span><span class="p">,</span> <span class="s1">&#39;0a1&#39;</span><span class="p">),</span> <span class="p">(</span><span class="s1">&#39;0b1&#39;</span><span class="p">,</span> <span class="s1">&#39;0b1&#39;</span><span class="p">),</span> <span class="p">(</span><span class="s1">&#39;0c1&#39;</span><span class="p">,</span> <span class="s1">&#39;0c1&#39;</span><span class="p">),</span> <span class="p">(</span><span class="s1">&#39;0d1&#39;</span><span class="p">,</span> <span class="s1">&#39;0d1&#39;</span><span class="p">)])</span>

<span class="n">df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">({</span><span class="s1">&#39;a&#39;</span><span class="p">:</span> <span class="p">[</span><span class="n">L</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">),</span> <span class="n">L</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span><span class="mi">3</span><span class="p">,</span><span class="mi">4</span><span class="p">),</span> <span class="n">L</span><span class="p">(</span><span class="mi">5</span><span class="p">,</span><span class="mi">6</span><span class="p">,</span><span class="mi">7</span><span class="p">)]})</span>
<span class="n">f</span> <span class="o">=</span> <span class="n">ColReader</span><span class="p">(</span><span class="s1">&#39;a&#39;</span><span class="p">)</span>
<span class="n">test_eq</span><span class="p">([</span><span class="n">f</span><span class="p">(</span><span class="n">o</span><span class="p">)</span> <span class="k">for</span> <span class="n">o</span> <span class="ow">in</span> <span class="n">df</span><span class="o">.</span><span class="n">itertuples</span><span class="p">()],</span> <span class="p">[</span><span class="n">L</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">),</span> <span class="n">L</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span><span class="mi">3</span><span class="p">,</span><span class="mi">4</span><span class="p">),</span> <span class="n">L</span><span class="p">(</span><span class="mi">5</span><span class="p">,</span><span class="mi">6</span><span class="p">,</span><span class="mi">7</span><span class="p">)])</span>
</pre></div>

    </div>
</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">

</div>
<div class="cell border-box-sizing code_cell rendered">

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_markdown rendered_html output_subarea ">
<h2 id="CategoryMap" class="doc_header"><code>class</code> <code>CategoryMap</code><a href="https://github.com/fastai/fastai2/tree/master/fastai2/data/transforms.py#L148" class="source_link" style="float:right">[source]</a></h2><blockquote><p><code>CategoryMap</code>(<strong><code>col</code></strong>, <strong><code>sort</code></strong>=<em><code>True</code></em>, <strong><code>add_na</code></strong>=<em><code>False</code></em>) :: <code>CollBase</code></p>
</blockquote>
<p>Collection of categories with the reverse mapping in <code>o2i</code></p>

</div>

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">t</span> <span class="o">=</span> <span class="n">CategoryMap</span><span class="p">([</span><span class="mi">4</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">3</span><span class="p">,</span><span class="mi">4</span><span class="p">])</span>
<span class="n">test_eq</span><span class="p">(</span><span class="n">t</span><span class="p">,</span> <span class="p">[</span><span class="mi">2</span><span class="p">,</span><span class="mi">3</span><span class="p">,</span><span class="mi">4</span><span class="p">])</span>
<span class="n">test_eq</span><span class="p">(</span><span class="n">t</span><span class="o">.</span><span class="n">o2i</span><span class="p">,</span> <span class="p">{</span><span class="mi">2</span><span class="p">:</span><span class="mi">0</span><span class="p">,</span><span class="mi">3</span><span class="p">:</span><span class="mi">1</span><span class="p">,</span><span class="mi">4</span><span class="p">:</span><span class="mi">2</span><span class="p">})</span>
<span class="n">test_fail</span><span class="p">(</span><span class="k">lambda</span><span class="p">:</span> <span class="n">t</span><span class="o">.</span><span class="n">o2i</span><span class="p">[</span><span class="s1">&#39;unseen label&#39;</span><span class="p">])</span>
</pre></div>

    </div>
</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">t</span> <span class="o">=</span> <span class="n">CategoryMap</span><span class="p">([</span><span class="mi">4</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">3</span><span class="p">,</span><span class="mi">4</span><span class="p">],</span> <span class="n">add_na</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="n">test_eq</span><span class="p">(</span><span class="n">t</span><span class="p">,</span> <span class="p">[</span><span class="s1">&#39;#na#&#39;</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">3</span><span class="p">,</span><span class="mi">4</span><span class="p">])</span>
<span class="n">test_eq</span><span class="p">(</span><span class="n">t</span><span class="o">.</span><span class="n">o2i</span><span class="p">,</span> <span class="p">{</span><span class="s1">&#39;#na#&#39;</span><span class="p">:</span><span class="mi">0</span><span class="p">,</span><span class="mi">2</span><span class="p">:</span><span class="mi">1</span><span class="p">,</span><span class="mi">3</span><span class="p">:</span><span class="mi">2</span><span class="p">,</span><span class="mi">4</span><span class="p">:</span><span class="mi">3</span><span class="p">})</span>
</pre></div>

    </div>
</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">t</span> <span class="o">=</span> <span class="n">CategoryMap</span><span class="p">(</span><span class="n">pd</span><span class="o">.</span><span class="n">Series</span><span class="p">([</span><span class="mi">4</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">3</span><span class="p">,</span><span class="mi">4</span><span class="p">]),</span> <span class="n">sort</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
<span class="n">test_eq</span><span class="p">(</span><span class="n">t</span><span class="p">,</span> <span class="p">[</span><span class="mi">4</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">3</span><span class="p">])</span>
<span class="n">test_eq</span><span class="p">(</span><span class="n">t</span><span class="o">.</span><span class="n">o2i</span><span class="p">,</span> <span class="p">{</span><span class="mi">4</span><span class="p">:</span><span class="mi">0</span><span class="p">,</span><span class="mi">2</span><span class="p">:</span><span class="mi">1</span><span class="p">,</span><span class="mi">3</span><span class="p">:</span><span class="mi">2</span><span class="p">})</span>
</pre></div>

    </div>
</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">col</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">Series</span><span class="p">(</span><span class="n">pd</span><span class="o">.</span><span class="n">Categorical</span><span class="p">([</span><span class="s1">&#39;M&#39;</span><span class="p">,</span><span class="s1">&#39;H&#39;</span><span class="p">,</span><span class="s1">&#39;L&#39;</span><span class="p">,</span><span class="s1">&#39;M&#39;</span><span class="p">],</span> <span class="n">categories</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;H&#39;</span><span class="p">,</span><span class="s1">&#39;M&#39;</span><span class="p">,</span><span class="s1">&#39;L&#39;</span><span class="p">],</span> <span class="n">ordered</span><span class="o">=</span><span class="kc">True</span><span class="p">))</span>
<span class="n">t</span> <span class="o">=</span> <span class="n">CategoryMap</span><span class="p">(</span><span class="n">col</span><span class="p">)</span>
<span class="n">test_eq</span><span class="p">(</span><span class="n">t</span><span class="p">,</span> <span class="p">[</span><span class="s1">&#39;H&#39;</span><span class="p">,</span><span class="s1">&#39;M&#39;</span><span class="p">,</span><span class="s1">&#39;L&#39;</span><span class="p">])</span>
<span class="n">test_eq</span><span class="p">(</span><span class="n">t</span><span class="o">.</span><span class="n">o2i</span><span class="p">,</span> <span class="p">{</span><span class="s1">&#39;H&#39;</span><span class="p">:</span><span class="mi">0</span><span class="p">,</span><span class="s1">&#39;M&#39;</span><span class="p">:</span><span class="mi">1</span><span class="p">,</span><span class="s1">&#39;L&#39;</span><span class="p">:</span><span class="mi">2</span><span class="p">})</span>
</pre></div>

    </div>
</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">

</div>
<div class="cell border-box-sizing code_cell rendered">

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_markdown rendered_html output_subarea ">
<h2 id="Categorize" class="doc_header"><code>class</code> <code>Categorize</code><a href="https://github.com/fastai/fastai2/tree/master/fastai2/data/transforms.py#L162" class="source_link" style="float:right">[source]</a></h2><blockquote><p><code>Categorize</code>(<strong><code>vocab</code></strong>=<em><code>None</code></em>, <strong><code>add_na</code></strong>=<em><code>False</code></em>) :: <code>Transform</code></p>
</blockquote>
<p>Reversible transform of category string to <code>vocab</code> id</p>

</div>

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">

</div>
<div class="cell border-box-sizing code_cell rendered">

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_markdown rendered_html output_subarea ">
<h2 id="Category" class="doc_header"><code>class</code> <code>Category</code><a href="https://github.com/fastai/fastai2/tree/master/fastai2/data/transforms.py#L177" class="source_link" style="float:right">[source]</a></h2><blockquote><p><code>Category</code>() :: <code>str</code></p>
</blockquote>
<p>str(object='') -&gt; str
str(bytes_or_buffer[, encoding[, errors]]) -&gt; str</p>
<p>Create a new string object from the given object. If encoding or
errors is specified, then the object must expose a data buffer
that will be decoded using the given encoding and error handler.
Otherwise, returns the result of object.<strong>str</strong>() (if defined)
or repr(object).
encoding defaults to sys.getdefaultencoding().
errors defaults to 'strict'.</p>

</div>

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">cat</span> <span class="o">=</span> <span class="n">Categorize</span><span class="p">()</span>
<span class="n">tds</span> <span class="o">=</span> <span class="n">DataSource</span><span class="p">([</span><span class="s1">&#39;cat&#39;</span><span class="p">,</span> <span class="s1">&#39;dog&#39;</span><span class="p">,</span> <span class="s1">&#39;cat&#39;</span><span class="p">],</span> <span class="n">tfms</span><span class="o">=</span><span class="p">[</span><span class="n">cat</span><span class="p">])</span>
<span class="n">test_eq</span><span class="p">(</span><span class="n">cat</span><span class="o">.</span><span class="n">vocab</span><span class="p">,</span> <span class="p">[</span><span class="s1">&#39;cat&#39;</span><span class="p">,</span> <span class="s1">&#39;dog&#39;</span><span class="p">])</span>
<span class="n">test_eq</span><span class="p">(</span><span class="n">cat</span><span class="p">(</span><span class="s1">&#39;cat&#39;</span><span class="p">),</span> <span class="mi">0</span><span class="p">)</span>
<span class="n">test_eq</span><span class="p">(</span><span class="n">cat</span><span class="o">.</span><span class="n">decode</span><span class="p">(</span><span class="mi">1</span><span class="p">),</span> <span class="s1">&#39;dog&#39;</span><span class="p">)</span>
<span class="n">test_stdout</span><span class="p">(</span><span class="k">lambda</span><span class="p">:</span> <span class="n">show_at</span><span class="p">(</span><span class="n">tds</span><span class="p">,</span><span class="mi">2</span><span class="p">),</span> <span class="s1">&#39;cat&#39;</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">cat</span> <span class="o">=</span> <span class="n">Categorize</span><span class="p">(</span><span class="n">add_na</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="n">tds</span> <span class="o">=</span> <span class="n">DataSource</span><span class="p">([</span><span class="s1">&#39;cat&#39;</span><span class="p">,</span> <span class="s1">&#39;dog&#39;</span><span class="p">,</span> <span class="s1">&#39;cat&#39;</span><span class="p">],</span> <span class="n">tfms</span><span class="o">=</span><span class="p">[</span><span class="n">cat</span><span class="p">])</span>
<span class="n">test_eq</span><span class="p">(</span><span class="n">cat</span><span class="o">.</span><span class="n">vocab</span><span class="p">,</span> <span class="p">[</span><span class="s1">&#39;#na#&#39;</span><span class="p">,</span> <span class="s1">&#39;cat&#39;</span><span class="p">,</span> <span class="s1">&#39;dog&#39;</span><span class="p">])</span>
<span class="n">test_eq</span><span class="p">(</span><span class="n">cat</span><span class="p">(</span><span class="s1">&#39;cat&#39;</span><span class="p">),</span> <span class="mi">1</span><span class="p">)</span>
<span class="n">test_eq</span><span class="p">(</span><span class="n">cat</span><span class="o">.</span><span class="n">decode</span><span class="p">(</span><span class="mi">2</span><span class="p">),</span> <span class="s1">&#39;dog&#39;</span><span class="p">)</span>
<span class="n">test_stdout</span><span class="p">(</span><span class="k">lambda</span><span class="p">:</span> <span class="n">show_at</span><span class="p">(</span><span class="n">tds</span><span class="p">,</span><span class="mi">2</span><span class="p">),</span> <span class="s1">&#39;cat&#39;</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">

</div>
<div class="cell border-box-sizing code_cell rendered">

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_markdown rendered_html output_subarea ">
<h2 id="MultiCategorize" class="doc_header"><code>class</code> <code>MultiCategorize</code><a href="https://github.com/fastai/fastai2/tree/master/fastai2/data/transforms.py#L180" class="source_link" style="float:right">[source]</a></h2><blockquote><p><code>MultiCategorize</code>(<strong><code>vocab</code></strong>=<em><code>None</code></em>, <strong><code>add_na</code></strong>=<em><code>False</code></em>) :: <a href="data.transforms.html#Categorize"><code>Categorize</code></a></p>
</blockquote>
<p>Reversible transform of multi-category strings to <code>vocab</code> id</p>

</div>

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">

</div>
<div class="cell border-box-sizing code_cell rendered">

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_markdown rendered_html output_subarea ">
<h2 id="MultiCategory" class="doc_header"><code>class</code> <code>MultiCategory</code><a href="https://github.com/fastai/fastai2/tree/master/fastai2/data/transforms.py#L198" class="source_link" style="float:right">[source]</a></h2><blockquote><p><code>MultiCategory</code>(<strong><code>items</code></strong>=<em><code>None</code></em>, <strong>*<code>rest</code></strong>, <strong><code>use_list</code></strong>=<em><code>False</code></em>, <strong><code>match</code></strong>=<em><code>None</code></em>) :: <code>L</code></p>
</blockquote>
<p>Behaves like a list of <code>items</code> but can also index with list of indices or masks</p>

</div>

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">cat</span> <span class="o">=</span> <span class="n">MultiCategorize</span><span class="p">()</span>
<span class="n">tds</span> <span class="o">=</span> <span class="n">DataSource</span><span class="p">([[</span><span class="s1">&#39;b&#39;</span><span class="p">,</span> <span class="s1">&#39;c&#39;</span><span class="p">],</span> <span class="p">[</span><span class="s1">&#39;a&#39;</span><span class="p">],</span> <span class="p">[</span><span class="s1">&#39;a&#39;</span><span class="p">,</span> <span class="s1">&#39;c&#39;</span><span class="p">],</span> <span class="p">[]],</span> <span class="n">tfms</span><span class="o">=</span><span class="p">[</span><span class="n">cat</span><span class="p">])</span>
<span class="n">test_eq</span><span class="p">(</span><span class="n">tds</span><span class="p">[</span><span class="mi">3</span><span class="p">][</span><span class="mi">0</span><span class="p">],</span> <span class="n">tensor</span><span class="p">([]))</span>
<span class="n">test_eq</span><span class="p">(</span><span class="n">cat</span><span class="o">.</span><span class="n">vocab</span><span class="p">,</span> <span class="p">[</span><span class="s1">&#39;a&#39;</span><span class="p">,</span> <span class="s1">&#39;b&#39;</span><span class="p">,</span> <span class="s1">&#39;c&#39;</span><span class="p">])</span>
<span class="n">test_eq</span><span class="p">(</span><span class="n">cat</span><span class="p">([</span><span class="s1">&#39;a&#39;</span><span class="p">,</span> <span class="s1">&#39;c&#39;</span><span class="p">]),</span> <span class="n">tensor</span><span class="p">([</span><span class="mi">0</span><span class="p">,</span><span class="mi">2</span><span class="p">]))</span>
<span class="n">test_eq</span><span class="p">(</span><span class="n">cat</span><span class="p">([]),</span> <span class="n">tensor</span><span class="p">([]))</span>
<span class="n">test_eq</span><span class="p">(</span><span class="n">cat</span><span class="o">.</span><span class="n">decode</span><span class="p">([</span><span class="mi">1</span><span class="p">]),</span> <span class="p">[</span><span class="s1">&#39;b&#39;</span><span class="p">])</span>
<span class="n">test_eq</span><span class="p">(</span><span class="n">cat</span><span class="o">.</span><span class="n">decode</span><span class="p">([</span><span class="mi">0</span><span class="p">,</span><span class="mi">2</span><span class="p">]),</span> <span class="p">[</span><span class="s1">&#39;a&#39;</span><span class="p">,</span> <span class="s1">&#39;c&#39;</span><span class="p">])</span>
<span class="n">test_stdout</span><span class="p">(</span><span class="k">lambda</span><span class="p">:</span> <span class="n">show_at</span><span class="p">(</span><span class="n">tds</span><span class="p">,</span><span class="mi">2</span><span class="p">),</span> <span class="s1">&#39;a;c&#39;</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">

</div>
<div class="cell border-box-sizing code_cell rendered">

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_markdown rendered_html output_subarea ">
<h2 id="OneHotEncode" class="doc_header"><code>class</code> <code>OneHotEncode</code><a href="https://github.com/fastai/fastai2/tree/master/fastai2/data/transforms.py#L203" class="source_link" style="float:right">[source]</a></h2><blockquote><p><code>OneHotEncode</code>(<strong><code>c</code></strong>=<em><code>None</code></em>) :: <code>Transform</code></p>
</blockquote>
<p>One-hot encodes targets</p>

</div>

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>Works in conjunction with <code>MultiCategorize</code> or on its own if you have one-hot encoded targets (pass a <code>vocab</code> for decoding and <code>do_encode=False</code> in this case)</p>

</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">_tfm</span> <span class="o">=</span> <span class="n">OneHotEncode</span><span class="p">(</span><span class="n">c</span><span class="o">=</span><span class="mi">3</span><span class="p">)</span>
<span class="n">test_eq</span><span class="p">(</span><span class="n">_tfm</span><span class="p">([</span><span class="mi">0</span><span class="p">,</span><span class="mi">2</span><span class="p">]),</span> <span class="n">tensor</span><span class="p">([</span><span class="mf">1.</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">]))</span>
<span class="n">test_eq</span><span class="p">(</span><span class="n">_tfm</span><span class="o">.</span><span class="n">decode</span><span class="p">(</span><span class="n">tensor</span><span class="p">([</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">])),</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">])</span>
</pre></div>

    </div>
</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">tds</span> <span class="o">=</span> <span class="n">DataSource</span><span class="p">([[</span><span class="s1">&#39;b&#39;</span><span class="p">,</span> <span class="s1">&#39;c&#39;</span><span class="p">],</span> <span class="p">[</span><span class="s1">&#39;a&#39;</span><span class="p">],</span> <span class="p">[</span><span class="s1">&#39;a&#39;</span><span class="p">,</span> <span class="s1">&#39;c&#39;</span><span class="p">],</span> <span class="p">[]],</span> <span class="p">[[</span><span class="n">MultiCategorize</span><span class="p">(),</span> <span class="n">OneHotEncode</span><span class="p">()]])</span>
<span class="n">test_eq</span><span class="p">(</span><span class="n">tds</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="p">[</span><span class="n">tensor</span><span class="p">([</span><span class="mf">1.</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">])])</span>
<span class="n">test_eq</span><span class="p">(</span><span class="n">tds</span><span class="p">[</span><span class="mi">3</span><span class="p">],</span> <span class="p">[</span><span class="n">tensor</span><span class="p">([</span><span class="mf">0.</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">])])</span>
<span class="n">test_eq</span><span class="p">(</span><span class="n">tds</span><span class="o">.</span><span class="n">decode</span><span class="p">([</span><span class="n">tensor</span><span class="p">([</span><span class="kc">False</span><span class="p">,</span> <span class="kc">True</span><span class="p">,</span> <span class="kc">True</span><span class="p">])]),</span> <span class="p">[[</span><span class="s1">&#39;b&#39;</span><span class="p">,</span><span class="s1">&#39;c&#39;</span><span class="p">]])</span>
<span class="n">test_eq</span><span class="p">(</span><span class="nb">type</span><span class="p">(</span><span class="n">tds</span><span class="p">[</span><span class="mi">1</span><span class="p">][</span><span class="mi">0</span><span class="p">]),</span> <span class="n">TensorMultiCategory</span><span class="p">)</span>
<span class="n">test_stdout</span><span class="p">(</span><span class="k">lambda</span><span class="p">:</span> <span class="n">show_at</span><span class="p">(</span><span class="n">tds</span><span class="p">,</span><span class="mi">2</span><span class="p">),</span> <span class="s1">&#39;a;c&#39;</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">

</div>
<div class="cell border-box-sizing code_cell rendered">

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_markdown rendered_html output_subarea ">
<h2 id="EncodedMultiCategorize" class="doc_header"><code>class</code> <code>EncodedMultiCategorize</code><a href="https://github.com/fastai/fastai2/tree/master/fastai2/data/transforms.py#L216" class="source_link" style="float:right">[source]</a></h2><blockquote><p><code>EncodedMultiCategorize</code>(<strong><code>vocab</code></strong>) :: <a href="data.transforms.html#Categorize"><code>Categorize</code></a></p>
</blockquote>
<p>Transform of one-hot encoded multi-category that decodes with <code>vocab</code></p>

</div>

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">_tfm</span> <span class="o">=</span> <span class="n">EncodedMultiCategorize</span><span class="p">(</span><span class="n">vocab</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;a&#39;</span><span class="p">,</span> <span class="s1">&#39;b&#39;</span><span class="p">,</span> <span class="s1">&#39;c&#39;</span><span class="p">])</span>
<span class="n">test_eq</span><span class="p">(</span><span class="n">_tfm</span><span class="p">([</span><span class="mi">1</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">]),</span> <span class="n">tensor</span><span class="p">([</span><span class="mf">1.</span><span class="p">,</span> <span class="mf">0.</span><span class="p">,</span> <span class="mf">1.</span><span class="p">]))</span>
<span class="n">test_eq</span><span class="p">(</span><span class="nb">type</span><span class="p">(</span><span class="n">_tfm</span><span class="p">([</span><span class="mi">1</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">])),</span> <span class="n">TensorCategory</span><span class="p">)</span>
<span class="n">test_eq</span><span class="p">(</span><span class="n">_tfm</span><span class="o">.</span><span class="n">decode</span><span class="p">(</span><span class="n">tensor</span><span class="p">([</span><span class="kc">False</span><span class="p">,</span> <span class="kc">True</span><span class="p">,</span> <span class="kc">True</span><span class="p">])),</span> <span class="p">[</span><span class="s1">&#39;b&#39;</span><span class="p">,</span><span class="s1">&#39;c&#39;</span><span class="p">])</span>
</pre></div>

    </div>
</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">

</div>
<div class="cell border-box-sizing code_cell rendered">

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_markdown rendered_html output_subarea ">
<h4 id="get_c" class="doc_header"><code>get_c</code><a href="https://github.com/fastai/fastai2/tree/master/fastai2/data/transforms.py#L224" class="source_link" style="float:right">[source]</a></h4><blockquote><p><code>get_c</code>(<strong><code>dbunch</code></strong>)</p>
</blockquote>

</div>

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h2 id="End-to-end-dataset-example-with-MNIST">End-to-end dataset example with MNIST<a class="anchor-link" href="#End-to-end-dataset-example-with-MNIST">&#182;</a></h2>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>Let's show how to use those functions to grab the mnist dataset in a <a href="data.core.html#DataSource"><code>DataSource</code></a>. First we grab all the images.</p>

</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">path</span> <span class="o">=</span> <span class="n">untar_data</span><span class="p">(</span><span class="n">URLs</span><span class="o">.</span><span class="n">MNIST_TINY</span><span class="p">)</span>
<span class="n">items</span> <span class="o">=</span> <span class="n">get_image_files</span><span class="p">(</span><span class="n">path</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>Then we split between train and validation depending on the folder.</p>

</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">splitter</span> <span class="o">=</span> <span class="n">GrandparentSplitter</span><span class="p">()</span>
<span class="n">splits</span> <span class="o">=</span> <span class="n">splitter</span><span class="p">(</span><span class="n">items</span><span class="p">)</span>
<span class="n">train</span><span class="p">,</span><span class="n">valid</span> <span class="o">=</span> <span class="p">(</span><span class="n">items</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">splits</span><span class="p">)</span>
<span class="n">train</span><span class="p">[:</span><span class="mi">3</span><span class="p">],</span><span class="n">valid</span><span class="p">[:</span><span class="mi">3</span><span class="p">]</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">



<div class="output_text output_subarea output_execute_result">
<pre>((#3) [/home/jhoward/.fastai/data/mnist_tiny/train/7/723.png,/home/jhoward/.fastai/data/mnist_tiny/train/7/7446.png,/home/jhoward/.fastai/data/mnist_tiny/train/7/8566.png],
 (#3) [/home/jhoward/.fastai/data/mnist_tiny/valid/7/946.png,/home/jhoward/.fastai/data/mnist_tiny/valid/7/9608.png,/home/jhoward/.fastai/data/mnist_tiny/valid/7/825.png])</pre>
</div>

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>Our inputs are images that we open and convert to tensors, our targets are labeled depending on the parent directory and are categories.</p>

</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="kn">from</span> <span class="nn">PIL</span> <span class="k">import</span> <span class="n">Image</span>
<span class="k">def</span> <span class="nf">open_img</span><span class="p">(</span><span class="n">fn</span><span class="p">:</span><span class="n">Path</span><span class="p">):</span> <span class="k">return</span> <span class="n">Image</span><span class="o">.</span><span class="n">open</span><span class="p">(</span><span class="n">fn</span><span class="p">)</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>
<span class="k">def</span> <span class="nf">img2tensor</span><span class="p">(</span><span class="n">im</span><span class="p">:</span><span class="n">Image</span><span class="o">.</span><span class="n">Image</span><span class="p">):</span> <span class="k">return</span> <span class="n">TensorImage</span><span class="p">(</span><span class="n">array</span><span class="p">(</span><span class="n">im</span><span class="p">)[</span><span class="kc">None</span><span class="p">])</span>

<span class="n">tfms</span> <span class="o">=</span> <span class="p">[[</span><span class="n">open_img</span><span class="p">,</span> <span class="n">img2tensor</span><span class="p">],</span>
        <span class="p">[</span><span class="n">parent_label</span><span class="p">,</span> <span class="n">Categorize</span><span class="p">()]]</span>
<span class="n">train_ds</span> <span class="o">=</span> <span class="n">DataSource</span><span class="p">(</span><span class="n">train</span><span class="p">,</span> <span class="n">tfms</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">x</span><span class="p">,</span><span class="n">y</span> <span class="o">=</span> <span class="n">train_ds</span><span class="p">[</span><span class="mi">3</span><span class="p">]</span>
<span class="n">xd</span><span class="p">,</span><span class="n">yd</span> <span class="o">=</span> <span class="n">decode_at</span><span class="p">(</span><span class="n">train_ds</span><span class="p">,</span><span class="mi">3</span><span class="p">)</span>
<span class="n">test_eq</span><span class="p">(</span><span class="n">parent_label</span><span class="p">(</span><span class="n">train</span><span class="p">[</span><span class="mi">3</span><span class="p">]),</span><span class="n">yd</span><span class="p">)</span>
<span class="n">test_eq</span><span class="p">(</span><span class="n">array</span><span class="p">(</span><span class="n">Image</span><span class="o">.</span><span class="n">open</span><span class="p">(</span><span class="n">train</span><span class="p">[</span><span class="mi">3</span><span class="p">])),</span><span class="n">xd</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">numpy</span><span class="p">())</span>
</pre></div>

    </div>
</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">ax</span> <span class="o">=</span> <span class="n">show_at</span><span class="p">(</span><span class="n">train_ds</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="n">cmap</span><span class="o">=</span><span class="s2">&quot;Greys&quot;</span><span class="p">,</span> <span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">))</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">



<div class="output_png output_subarea ">
<img src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAEQAAABUCAYAAAA7xZEpAAAABHNCSVQICAgIfAhkiAAAAAlwSFlzAAALEgAACxIB0t1+/AAAADh0RVh0U29mdHdhcmUAbWF0cGxvdGxpYiB2ZXJzaW9uMy4xLjAsIGh0dHA6Ly9tYXRwbG90bGliLm9yZy+17YcXAAADj0lEQVR4nO2aPUscURSGnyt+gBu1EkQxIqQSC0FETaGigqBtFG0SG3+DjY2lgo0pxSIpRIimUKxiISSCohYWIigYwcYvRI2Nok6KMGzmZLM7rrN7L3IeWNg5O8w5vPvOuXPurvE8DyVOju0CXEMFEaggAhVEoIIIVBCBCiKwLogx5ka8HowxH23Vk2srsY/nea/898aYGHACfLFVj3WHCN4Bp8B3WwW4JsgH4LNncZ4wrswyxpjXwE/gjed5P23V4ZJD3gM/bIoB7gnyyXYRTtwyxpi3wDegzPO8XzZrccUhH4CvtsUARxziEq44xBlUEIEKIlBBBKmGu5fccU2ioDpEoIIIVBCBCiJQQQQqiEAFEaggAhVEoIIIVBCBCiJQQQRWfsq8u7sD4OHhAYDT01Pm5uYAWFtbA2B+fh4Af4tzcHAQgN7eXgC6u7szUps6RJBqkznUfsj9/T0A19fXgfjU1BQAl5eXgfjS0hIAOzs7IcuM09XVBcDCwgIAublpm1z3Q8IQiUM2NzcBaGxsTLuQpqYmAGKxGACdnZ0AnJ+fAzAxMRE4/+DgAICqqqp0U6pDwhDJKuP3kP9hzJ8vo7+/P+HnQ0NDNDc3A5Cfn5/w2u3t7QD09PQAMDs7C8Dw8HCaVSdGHSKIxCH19fUAHB0dJT2vvLz8ydf2V5HCwsJA/PDw8MnXCoM6RBCJQ/Ly8oD0HJCK29tbAEZHRwPxhoaGyHOBOuQfrP8tMxUbGxsArKysBOIdHR0Zyee8IMvLy4HjgoIC4FmP7EnRW0bgrEP8keLi4iIQ97cBKioqMpJXHSKIZLjLBGdnZwCUlZUBUFRUBMD29jbwrKHOR4e7MDjbQ1paWgLHAwMDQCTOSIo6ROCcQ8bHxwHY29sD4r0j6jH/f6hDBM6sMqurqwC0tbUB8SdR/9G9trY26pS6yoTBmR6yuLgIwOPjIwDFxcVARpyRFHWIwAmHzMzMMD09HYitr69bqUUdIrC6yuzv7wPQ2trKyckJEJ9d/A3rnJyMfWe6yoTBikOurq4AqKmpAeD4+Ji+vj4AJicnASgtLc1E6r9Rh4Qhq6uM/7PkyMgI8McZAJWVlYyNjQFZcUZS1CGCrPaQm5sbAEpKSgLxra0t6urqokwVBu0hYchqD9nd3Q0c+7tf1dXV2SwjKeoQgTP7IRbQHhKGVD0koYovGXWIQAURqCACFUSggghUEMFvi57zogPe+9UAAAAASUVORK5CYII=
"
>
</div>

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="k">assert</span> <span class="n">ax</span><span class="o">.</span><span class="n">title</span><span class="o">.</span><span class="n">get_text</span><span class="p">()</span> <span class="ow">in</span> <span class="p">(</span><span class="s1">&#39;3&#39;</span><span class="p">,</span><span class="s1">&#39;7&#39;</span><span class="p">)</span>
<span class="n">test_fig_exists</span><span class="p">(</span><span class="n">ax</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">

</div>
<div class="cell border-box-sizing code_cell rendered">

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_markdown rendered_html output_subarea ">
<h2 id="ToTensor" class="doc_header"><code>class</code> <code>ToTensor</code><a href="https://github.com/fastai/fastai2/tree/master/fastai2/data/transforms.py#L231" class="source_link" style="float:right">[source]</a></h2><blockquote><p><code>ToTensor</code>(<strong><code>enc</code></strong>=<em><code>None</code></em>, <strong><code>dec</code></strong>=<em><code>None</code></em>, <strong><code>split_idx</code></strong>=<em><code>None</code></em>, <strong><code>as_item</code></strong>=<em><code>False</code></em>, <strong><code>order</code></strong>=<em><code>None</code></em>) :: <code>Transform</code></p>
</blockquote>
<p>Convert item to appropriate tensor class</p>

</div>

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">

</div>
<div class="cell border-box-sizing code_cell rendered">

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_markdown rendered_html output_subarea ">
<h2 id="Cuda" class="doc_header"><code>class</code> <code>Cuda</code><a href="https://github.com/fastai/fastai2/tree/master/fastai2/data/transforms.py#L237" class="source_link" style="float:right">[source]</a></h2><blockquote><p><code>Cuda</code>(<strong><code>device</code></strong>=<em><code>None</code></em>) :: <code>Transform</code></p>
</blockquote>
<p>Move batch to <code>device</code> (defaults to <code>default_device()</code>)</p>

</div>

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_markdown rendered_html output_subarea ">
<h4 id="Cuda.encodes" class="doc_header"><code>Cuda.encodes</code><a href="https://github.com/fastai/fastai2/tree/master/fastai2/data/transforms.py#L242" class="source_link" style="float:right">[source]</a></h4><blockquote><p><code>Cuda.encodes</code>()</p>
</blockquote>
<p>Move batch to <code>device</code></p>

</div>

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>Note that, like all <code>Transform</code>s, <a href="tabular.core.html#encodes"><code>encodes</code></a> is called by <code>tfm()</code> and <a href="tabular.core.html#decodes"><code>decodes</code></a> is called by <code>tfm.decode()</code>.</p>

</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">tfm</span> <span class="o">=</span> <span class="n">Cuda</span><span class="p">()</span>
<span class="n">t</span> <span class="o">=</span> <span class="n">tfm</span><span class="p">((</span><span class="n">tensor</span><span class="p">(</span><span class="mi">1</span><span class="p">),))</span>
<span class="n">test_eq</span><span class="p">(</span><span class="o">*</span><span class="n">t</span><span class="p">,</span><span class="mi">1</span><span class="p">)</span>
<span class="n">test_eq</span><span class="p">(</span><span class="n">t</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">type</span><span class="p">(),</span><span class="s1">&#39;torch.cuda.LongTensor&#39;</span> <span class="k">if</span> <span class="n">default_device</span><span class="p">()</span><span class="o">.</span><span class="n">type</span><span class="o">==</span><span class="s1">&#39;cuda&#39;</span> <span class="k">else</span> <span class="s1">&#39;torch.LongTensor&#39;</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_markdown rendered_html output_subarea ">
<h4 id="Cuda.decodes" class="doc_header"><code>Cuda.decodes</code><a href="https://github.com/fastai/fastai2/tree/master/fastai2/data/transforms.py#L243" class="source_link" style="float:right">[source]</a></h4><blockquote><p><code>Cuda.decodes</code>()</p>
</blockquote>
<p>Return batch to CPU</p>

</div>

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">t</span> <span class="o">=</span> <span class="n">tfm</span><span class="o">.</span><span class="n">decode</span><span class="p">(</span><span class="n">t</span><span class="p">)</span>
<span class="n">test_eq</span><span class="p">(</span><span class="o">*</span><span class="n">t</span><span class="p">,</span><span class="mi">1</span><span class="p">)</span>
<span class="n">test_eq</span><span class="p">(</span><span class="n">t</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">type</span><span class="p">(),</span><span class="s1">&#39;torch.LongTensor&#39;</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="k">class</span> <span class="nc">A</span><span class="p">(</span><span class="n">Transform</span><span class="p">):</span> 
    <span class="k">def</span> <span class="nf">encodes</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">x</span><span class="p">):</span> <span class="k">return</span> <span class="n">x</span> 
    <span class="k">def</span> <span class="nf">decodes</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">x</span><span class="p">):</span> <span class="k">return</span> <span class="n">Int</span><span class="p">(</span><span class="n">x</span><span class="p">)</span> 
    
<span class="n">start</span> <span class="o">=</span> <span class="n">torch</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="mi">50</span><span class="p">)</span>
<span class="n">tds</span> <span class="o">=</span> <span class="n">DataSource</span><span class="p">(</span><span class="n">start</span><span class="p">,</span> <span class="p">[</span><span class="n">A</span><span class="p">()])</span>
<span class="n">tdl</span> <span class="o">=</span> <span class="n">TfmdDL</span><span class="p">(</span><span class="n">tds</span><span class="p">,</span> <span class="n">after_batch</span><span class="o">=</span><span class="n">Cuda</span><span class="p">,</span> <span class="n">bs</span><span class="o">=</span><span class="mi">4</span><span class="p">)</span>
<span class="n">test_eq</span><span class="p">(</span><span class="n">tdl</span><span class="o">.</span><span class="n">device</span><span class="p">,</span> <span class="n">default_device</span><span class="p">())</span>
</pre></div>

    </div>
</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">

</div>
<div class="cell border-box-sizing code_cell rendered">

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_markdown rendered_html output_subarea ">
<h2 id="IntToFloatTensor" class="doc_header"><code>class</code> <code>IntToFloatTensor</code><a href="https://github.com/fastai/fastai2/tree/master/fastai2/data/transforms.py#L248" class="source_link" style="float:right">[source]</a></h2><blockquote><p><code>IntToFloatTensor</code>(<strong><code>div</code></strong>=<em><code>255.0</code></em>, <strong><code>div_mask</code></strong>=<em><code>1</code></em>, <strong><code>split_idx</code></strong>=<em><code>None</code></em>, <strong><code>as_item</code></strong>=<em><code>True</code></em>) :: <code>Transform</code></p>
</blockquote>
<p>Transform image to float tensor, optionally dividing by 255 (e.g. for images).</p>

</div>

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">t</span> <span class="o">=</span> <span class="p">(</span><span class="n">TensorImage</span><span class="p">(</span><span class="n">tensor</span><span class="p">(</span><span class="mi">1</span><span class="p">)),</span><span class="n">tensor</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span><span class="o">.</span><span class="n">long</span><span class="p">(),</span><span class="n">TensorMask</span><span class="p">(</span><span class="n">tensor</span><span class="p">(</span><span class="mi">3</span><span class="p">)))</span>
<span class="n">tfm</span> <span class="o">=</span> <span class="n">IntToFloatTensor</span><span class="p">(</span><span class="n">as_item</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
<span class="n">ft</span> <span class="o">=</span> <span class="n">tfm</span><span class="p">(</span><span class="n">t</span><span class="p">)</span>
<span class="n">test_eq</span><span class="p">(</span><span class="n">ft</span><span class="p">,</span> <span class="p">[</span><span class="mf">1.</span><span class="o">/</span><span class="mi">255</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">])</span>
<span class="n">test_eq</span><span class="p">(</span><span class="nb">type</span><span class="p">(</span><span class="n">ft</span><span class="p">[</span><span class="mi">0</span><span class="p">]),</span> <span class="n">TensorImage</span><span class="p">)</span>
<span class="n">test_eq</span><span class="p">(</span><span class="nb">type</span><span class="p">(</span><span class="n">ft</span><span class="p">[</span><span class="mi">2</span><span class="p">]),</span> <span class="n">TensorMask</span><span class="p">)</span>
<span class="n">test_eq</span><span class="p">(</span><span class="n">ft</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">type</span><span class="p">(),</span><span class="s1">&#39;torch.FloatTensor&#39;</span><span class="p">)</span>
<span class="n">test_eq</span><span class="p">(</span><span class="n">ft</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">type</span><span class="p">(),</span><span class="s1">&#39;torch.LongTensor&#39;</span><span class="p">)</span>
<span class="n">test_eq</span><span class="p">(</span><span class="n">ft</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span><span class="o">.</span><span class="n">type</span><span class="p">(),</span><span class="s1">&#39;torch.LongTensor&#39;</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">

</div>
<div class="cell border-box-sizing code_cell rendered">

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_markdown rendered_html output_subarea ">
<h4 id="broadcast_vec" class="doc_header"><code>broadcast_vec</code><a href="https://github.com/fastai/fastai2/tree/master/fastai2/data/transforms.py#L260" class="source_link" style="float:right">[source]</a></h4><blockquote><p><code>broadcast_vec</code>(<strong><code>dim</code></strong>, <strong><code>ndim</code></strong>, <strong>*<code>t</code></strong>, <strong><code>cuda</code></strong>=<em><code>True</code></em>)</p>
</blockquote>
<p>Make a vector broadcastable over <code>dim</code> (out of <code>ndim</code> total) by prepending and appending unit axes</p>

</div>

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">

</div>
<div class="cell border-box-sizing code_cell rendered">

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_markdown rendered_html output_subarea ">
<h2 id="Normalize" class="doc_header"><code>class</code> <code>Normalize</code><a href="https://github.com/fastai/fastai2/tree/master/fastai2/data/transforms.py#L269" class="source_link" style="float:right">[source]</a></h2><blockquote><p><code>Normalize</code>(<strong><code>mean</code></strong>=<em><code>None</code></em>, <strong><code>std</code></strong>=<em><code>None</code></em>, <strong><code>axes</code></strong>=<em><code>(0, 2, 3)</code></em>) :: <code>Transform</code></p>
</blockquote>
<p>Normalize/denorm batch of <a href="torch.core.html#TensorImage"><code>TensorImage</code></a></p>

</div>

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">mean</span><span class="p">,</span><span class="n">std</span> <span class="o">=</span> <span class="p">[</span><span class="mf">0.5</span><span class="p">]</span><span class="o">*</span><span class="mi">3</span><span class="p">,[</span><span class="mf">0.5</span><span class="p">]</span><span class="o">*</span><span class="mi">3</span>
<span class="n">mean</span><span class="p">,</span><span class="n">std</span> <span class="o">=</span> <span class="n">broadcast_vec</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="n">mean</span><span class="p">,</span> <span class="n">std</span><span class="p">)</span>
<span class="n">batch_tfms</span> <span class="o">=</span> <span class="p">[</span><span class="n">Cuda</span><span class="p">(),</span> <span class="n">IntToFloatTensor</span><span class="p">(),</span> <span class="n">Normalize</span><span class="o">.</span><span class="n">from_stats</span><span class="p">(</span><span class="n">mean</span><span class="p">,</span><span class="n">std</span><span class="p">)]</span>
<span class="n">tdl</span> <span class="o">=</span> <span class="n">TfmdDL</span><span class="p">(</span><span class="n">train_ds</span><span class="p">,</span> <span class="n">after_batch</span><span class="o">=</span><span class="n">batch_tfms</span><span class="p">,</span> <span class="n">bs</span><span class="o">=</span><span class="mi">4</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">x</span><span class="p">,</span><span class="n">y</span>  <span class="o">=</span> <span class="n">tdl</span><span class="o">.</span><span class="n">one_batch</span><span class="p">()</span>
<span class="n">xd</span><span class="p">,</span><span class="n">yd</span> <span class="o">=</span> <span class="n">tdl</span><span class="o">.</span><span class="n">after_batch</span><span class="o">.</span><span class="n">decode</span><span class="p">((</span><span class="n">x</span><span class="p">,</span><span class="n">y</span><span class="p">))</span>

<span class="n">test_eq</span><span class="p">(</span><span class="n">x</span><span class="o">.</span><span class="n">type</span><span class="p">(),</span> <span class="s1">&#39;torch.cuda.FloatTensor&#39;</span> <span class="k">if</span> <span class="n">default_device</span><span class="p">()</span><span class="o">.</span><span class="n">type</span><span class="o">==</span><span class="s1">&#39;cuda&#39;</span> <span class="k">else</span> <span class="s1">&#39;torch.FloatTensor&#39;</span><span class="p">)</span>
<span class="n">test_eq</span><span class="p">(</span><span class="n">xd</span><span class="o">.</span><span class="n">type</span><span class="p">(),</span> <span class="s1">&#39;torch.FloatTensor&#39;</span><span class="p">)</span>
<span class="n">test_eq</span><span class="p">(</span><span class="nb">type</span><span class="p">(</span><span class="n">x</span><span class="p">),</span> <span class="n">TensorImage</span><span class="p">)</span>
<span class="n">test_eq</span><span class="p">(</span><span class="nb">type</span><span class="p">(</span><span class="n">y</span><span class="p">),</span> <span class="n">TensorCategory</span><span class="p">)</span>
<span class="k">assert</span> <span class="n">x</span><span class="o">.</span><span class="n">mean</span><span class="p">()</span><span class="o">&lt;</span><span class="mf">0.0</span>
<span class="k">assert</span> <span class="n">x</span><span class="o">.</span><span class="n">std</span><span class="p">()</span><span class="o">&gt;</span><span class="mf">0.5</span>
<span class="k">assert</span> <span class="mi">0</span><span class="o">&lt;</span><span class="n">xd</span><span class="o">.</span><span class="n">mean</span><span class="p">()</span><span class="o">/</span><span class="mf">255.</span><span class="o">&lt;</span><span class="mi">1</span>
<span class="k">assert</span> <span class="mi">0</span><span class="o">&lt;</span><span class="n">xd</span><span class="o">.</span><span class="n">std</span><span class="p">()</span><span class="o">/</span><span class="mf">255.</span><span class="o">&lt;</span><span class="mf">0.5</span>
</pre></div>

    </div>
</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="c1">#Just for visuals</span>
<span class="kn">from</span> <span class="nn">fastai2.vision.core</span> <span class="k">import</span> <span class="o">*</span>
</pre></div>

    </div>
</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">tdl</span><span class="o">.</span><span class="n">show_batch</span><span class="p">((</span><span class="n">x</span><span class="p">,</span><span class="n">y</span><span class="p">))</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">



<div class="output_png output_subarea ">
<img src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAOcAAAD3CAYAAADmIkO7AAAABHNCSVQICAgIfAhkiAAAAAlwSFlzAAALEgAACxIB0t1+/AAAADh0RVh0U29mdHdhcmUAbWF0cGxvdGxpYiB2ZXJzaW9uMy4xLjAsIGh0dHA6Ly9tYXRwbG90bGliLm9yZy+17YcXAAAHcUlEQVR4nO3db6jeZR3H8et39qfNmaN0VqJzgXMtZWqKpRU4aEUWPmhbRckZOVQSexBFPYmkoLD1IJ34px5oCSY0mP0x2Bx7kn9mZtEWWxaLpZQ1W6Xuj7Z2zq8H0YPV+V2nnfuc3Z9zn9cLBnK+/O7r4sz3LvHafe6mbdsC5Bnq9waAsYkTQokTQokTQokTQokTQokTQolzADRNc+i/fo00TXNHv/dFb2b3ewP0rm3bU//zz03TLCil7C+lbOrfjpgMTs7Bs6aU8kIp5dF+b4TeiHPwrCul3N/6e5nTXuP3cHA0TbO4lLKvlHJe27b7+r0feuPkHCzDpZTHhDkYxDlYhksp3+n3Jpgc/rN2QDRNc2UpZVsp5Y1t2x7s937onZNzcKwrpWwW5uBwckIoJyeEEieEEieEEieEqv7F91VDa/3fIphi20Y3NWN93ckJocQJocQJocQJocQJocQJocQJocQJocQJocQJocQJocQJocQJocQJocQJocQJocQJocQJocQJocQJocQJocQJocQJocQJocQJocQJocQJocQJocQJocQJocQJocQJocQJocQJocQJocQJocQJocQJocQJocQJocQJocQJocQJocQJocQJocQJocQJocQJocQJocQJocQJocQJocQJoWb3ewODaGjBgur8r2tXdM52fOXO6rO/PHqsOl+z5ebq/Kw3H6jOH1+xuXP2+f0XV5/93pOXV+dT6bV76/8qn3X7U9V5e6z+fe0HJyeEEieEEieEEieEEieEEieEEieEatq27RyuGlrbPZzBZi1fWp0P3X2oOn9o6cOTuR3+D9dcfW11Prrz1ydpJ/9r2+imZqyvOzkhlDghlDghlDghlDghlDghlDghlPdzjmHWokXV+erNj1bnw6f9cTK3c5zzH7mhOj/9sbk9vf6Z1z7bObvh7J9Un/3AKS/1tHYvdo/zPtfmlaMnaSeTx8kJocQJocQJocQJocQJocQJocQJoWbk+znHu8f8x4Pzq/Mtyx/qaf3RMto5u2rXR6vPvv6m+n3esX3d95S9mrXsvOr892vOrM533nTHZG7nOO/e+ZHqfOHVe6ds7V55PydMM+KEUOKEUOKEUOKEUOKEUOKEUDPy/ZyvXnJudb51+TendP1bD1zUOTvt/b+rPtvPT5F8/n31e8x71t81ZWs//uqc6nz+xtdN2dr94uSEUOKEUOKEUOKEUOKEUOKEUDPyKmXeH16uzt+750PV+SNv3VydX7RjXXW+5JP7K9O/VJ/tp5GVL1bnV7xmZMrW/uytN1bnp2/ZMWVr94uTE0KJE0KJE0KJE0KJE0KJE0KJE0LNyB+NOZ5mdv36d+jUBdV5e/Sf1fnokSMnvKdJMzSrOt57/4rO2Z6V36q/dI9/1i/bfn3n7PzrdlWfbY/18810vfGjMWGaESeEEieEEieEEieEEieEEieEmpHv5xzPeHdmIy++dJJ2cuKG5s2rzp+/8W3V+TMrax/TV/+zvPbRhqWU8qUXLq3Olw7/onM2Ey/cnZwQSpwQSpwQSpwQSpwQSpwQSpwQyj3ngDnynu73Y5ZSytOfq91j9uYHh8+ozn9+ibPgRPhuQShxQihxQihxQihxQihxQihxQij3nNNMc+kF1fmBTxyesrW3v3JKdX7vx68Z5xV+NXmbmQGcnBBKnBBKnBBKnBBKnBBKnBDKVUqYoQX1jxdcuPFP1fmPlmzraf0fH1nYObtreHX12eZnO3tam+M5OSGUOCGUOCGUOCGUOCGUOCGUOCGUe84+aGZ3f9v//N1zqs/+cMkDk72d43zj0x/rnM3b8dSUrs3xnJwQSpwQSpwQSpwQSpwQSpwQSpwQyj1nHzz7hcs7Z7su6+0j+sb78ZWfuXd9dX7O1qc7Z+2EdsREOTkhlDghlDghlDghlDghlDghlDghlHvOKfDcLVdW57uu7+0us+bb+99ZnZ/91Seqc3eZOZycEEqcEEqcEEqcEEqcEEqcEMpVygQcXv326vzh6zaM8wrzJ7z2xU8OV+fnfvHYOK/wtwmvzcnl5IRQ4oRQ4oRQ4oRQ4oRQ4oRQ4oRQ7jnHcOjD76jO795wW3W+ePbE7zHve7n+EYCLbxmpzkd2/2bCa5PFyQmhxAmhxAmhxAmhxAmhxAmhxAmhZuQ9Z3PZhdX5nV+7vTpfPmdOT+s/ePANnbPvr35X9dnRPc/0tDbTh5MTQokTQokTQokTQokTQokTQokTQs3Ie87ffmpudX7B3N6+LQ8cfFN1vvG21Z2zRXt29LQ2g8PJCaHECaHECaHECaHECaHECaHECaEG9p7z7+uu6Jxtv+rr4zw98Z87W0opX/7pB6vzpfe4y2R8Tk4IJU4IJU4IJU4IJU4IJU4INbBXKWc8sb9ztvXwsuqz6xc+V51feN/N1flbNuyuzusf4gf/5uSEUOKEUOKEUOKEUOKEUOKEUOKEUE3btp3DVUNru4fApNg2uqkZ6+tOTgglTgglTgglTgglTgglTgglTghVvecE+sfJCaHECaHECaHECaHECaHECaH+BfC2ISxVaokHAAAAAElFTkSuQmCC
"
>
</div>

</div>

<div class="output_area">



<div class="output_png output_subarea ">
<img src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAOcAAAD3CAYAAADmIkO7AAAABHNCSVQICAgIfAhkiAAAAAlwSFlzAAALEgAACxIB0t1+/AAAADh0RVh0U29mdHdhcmUAbWF0cGxvdGxpYiB2ZXJzaW9uMy4xLjAsIGh0dHA6Ly9tYXRwbG90bGliLm9yZy+17YcXAAAGaElEQVR4nO3dX8iecxzH8d/1PNv8/xfDgZTYbBMrkoYTMgdyIG2UsglTpEQO/DlBcWhJijjBEZNSSO1AIvMvpmSGmtFiGLNpiOe5HFHTc/+W+3ru3Z/d9+tVq3V/n/u6fm29+639nut+mrZtC5BnYtgLAGYmTgglTgglTgglTgglTgglTgglzhHQNM2v//k11TTNo8NeF93MGfYC6K5t28P/+X3TNIeVUraXUtYNb0XMBjvn6FlRSvm+lPLmsBdCN+IcPatLKc+0vi/zgNf4OxwdTdOcXErZUko5rW3bLcNeD93YOUfLqlLKW8IcDeIcLatKKU8PexHMDv+sHRFN05xfSllfSjmxbdvdw14P3dk5R8fqUsqLwhwddk4IZeeEUOKEUOKEUOKEUNVvfF8+sdL/FsGArZ9e18z0up0TQokTQokTQokTQokTQokTQokTQokTQokTQokTQokTQokTQokTQokTQokTQokTQokTQokTQokTQokTQokTQokTQokTQokTQokTQokTQokTQokTQokTQokTQokTQokTQokTQokTQokTQokTQokTQokTQokTQokTQokTQokTQokTQokTQokTQokTQokTQokTQokTQokTQokTQokTQokTQs0Z9gKGYfL006rzV19/odP1p9rp6vzN33v/sV//8k2d7t3Vosd39Jy1W7dV3zv922/1i7dtP0saW3ZOCCVOCCVOCCVOCCVOCCVOCCVOCDWW55w/XDC/Ov95ak91fvjEQZ3uf8HBf/acbV7xWKdrd7ai/7cueeOG6nzBfbur86kvv+o9nJ7qY0UHNjsnhBInhBInhBInhBInhBInhBInhGrayjN2yydWjuUDeDvWLKvOn7jnkYHd+/bPr67O1y58rtP1j5jofcZaSimnzDm40/W7uOLCK3vO/tqydT+uZP9aP72umel1OyeEEieEEieEEieEEieEEieEEieEcs45ZiaXLKzON915ZM/Zxksfrb730GZeX2v6h3POvdk5IZQ4IZQ4IZQ4IZQ4IZQ4IZQ4IdRYfm7tOJv69PPq/NRnz+4523rxjMdx/1o8t68l0YOdE0KJE0KJE0KJE0KJE0KJE0I5Shkzk0cfVZ1/c37vj8ZcPLfbWcmXf/5R/4K/xu/H/NXYOSGUOCGUOCGUOCGUOCGUOCGUOCGUc84x89Pli6vzj2+pf/xlF9fffUd1fuQ37wzs3gciOyeEEieEEieEEieEEieEEieEEieEcs45YiaPO7b+Bdf8OLB7r/7qkur8mFc+rc49zbk3OyeEEieEEieEEieEEieEEieEEieEcs45YrZde3p1/sHSwT2v+c5HC6vzBbveHdi9R5GdE0KJE0KJE0KJE0KJE0KJE0KJE0I55zzA7Fy1rDp/9raH93GF/n/G5tINq6vzRfdsqs49r/n/2DkhlDghlDghlDghlDghlDghlKOUMO2ypdX5kw+src4Xz+3/qKSUUs56+7qes1PWfF1979SuXZ3uzd7snBBKnBBKnBBKnBBKnBBKnBBKnBDKOecQTM6f33O25/5fqu/teo5567YLq/PaWebUzvramF12TgglTgglTgglTgglTgglTgglTgjlnHMINq89qefsszOe6nTtDX9MVuebHjyzOj9k53ud7s/ssXNCKHFCKHFCKHFCKHFCKHFCKHFCKOecA1B7XrOUUq5csnFg977jwZur82Nf2jCwezO77JwQSpwQSpwQSpwQSpwQSpwQylHKAHx71YLq/KUTXuv72nd9d251Pv/5T6rz6b7vzP5m54RQ4oRQ4oRQ4oRQ4oRQ4oRQ4oRQzjn7sK9Hwi65of/Hsvb10ZYf3ntOdT5v9/t935ssdk4IJU4IJU4IJU4IJU4IJU4IJU4I5ZyzD9MnH1+dP9Thec3nd5xXnc97zTnmuLBzQihxQihxQihxQihxQihxQihxQijnnGFe+fjM6nxh+WA/rYRhs3NCKHFCKHFCKHFCKHFCKHFCKHFCKOecYZo99c+tZXzYOSGUOCGUOCGUOCGUOCGUOCGUo5Q+TG7fWZ0vev3G6vyzi57qObts2cbqe7+oThkldk4IJU4IJU4IJU4IJU4IJU4IJU4I1bRt23O4fGJl7yEwK9ZPr2tmet3OCaHECaHECaHECaHECaHECaHECaGq55zA8Ng5IZQ4IZQ4IZQ4IZQ4IZQ4IdTfjyzj9eqzYKoAAAAASUVORK5CYII=
"
>
</div>

</div>

<div class="output_area">



<div class="output_png output_subarea ">
<img src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAOcAAAD3CAYAAADmIkO7AAAABHNCSVQICAgIfAhkiAAAAAlwSFlzAAALEgAACxIB0t1+/AAAADh0RVh0U29mdHdhcmUAbWF0cGxvdGxpYiB2ZXJzaW9uMy4xLjAsIGh0dHA6Ly9tYXRwbG90bGliLm9yZy+17YcXAAAGf0lEQVR4nO3dX6jXdx3H8c/3OFPyT+7CnDQ38t9FS8qNQVOZu5iwsBtJYSPmgaASajF2k2OEMCqKbjIDazqYu9gYR0a7WYkEQeoQNoyxJWOgVqyhbayRiw31fLvaheHvk/v9zu/8Xud7Hg8Q5Lz9fb+fc+TpR/yc78+mbdsC5Bkb9QKAaxMnhBInhBInhBInhBInhBInhBJnBzRNc/F/flxpmmbfqNfFYG4Y9QIYXNu2Cz/+edM0C0op50spE6NbEVPBztk920spF0opfxr1QhiMOLtnvJTydOv7Mme8xu9hdzRNc0sp5WwpZXXbtmdHvR4GY+fslp2llGPC7AZxdsvOUsqhUS+CqeGvtR3RNM2GUsrRUspNbdv+e9TrYXB2zu4YL6U8L8zusHNCKDsnhBInhBInhBInhKp+4/uWsR3+tQiG7OjkRHOtj9s5IZQ4IZQ4IZQ4IZQ4IZQ4IZQ4IZQ4IZQ4IZQ4IZQ4IZQ4IZQ4IZQ4IZQ4IZQ4IZQ4IZQ4IZQ4IZQ4IZQ4IZQ4IZQ4IZQ4IZQ4IZQ4IZQ4IZQ4IZQ4IZQ4IZQ4IZQ4IZQ4IZQ4IZQ4IZQ4IZQ4IZQ4IZQ4IZQ4IZQ4IZQ4IZQ4IZQ4IZQ4IZQ4IZQ4IZQ4IZQ4IZQ4IZQ4IZQ4IZQ4IdQNo14AVzvzs7vqv6CdnnXMNCt3vzTqJUw5OyeEEieEEieEEieEEieEEieEEieEij3nfPuRDdX5D77zXHX+lfl/7Tl78eJt1dfuf3ZrdX5pUf2w8ff3/7w6r1k198/1e7dX+r52l31t9x2jXsKUs3NCKHFCKHFCKHFCKHFCKHFCKHFCqKZte5/ZbRnbMdDTg3//Ye+zyl+MH6i+dtP8D6rzuc2cvtY0HS5OflSdbzz57Z6zHWtOVV87MbG5Ov9wdf3e8xfW54P4yZd+W51v/fT7fV97z4X11fkr62fuPnN0cqK51sdn7mcEHSdOCCVOCCVOCCVOCCVOCCVOCDXU5zmf+ubenrP1n/p/fy4Mdo45fu7enrOX3lhVfe2yP9S/LD99/In6fPvO6nzFqdd6zl7+3K311759sjovk6N73vOxR+uf99bv7ev72oePbKzOP1+8by0wTcQJocQJocQJocQJocQJocQJoYZ6zvngM9/vOVt395sDXfut/aur8xtfPN1ztvZfL1dfO7ZoUXX+47+N119/qv5MZs3lt/7R92uHbc7SpdX5pm39f96llPJRe6nnbGHvtyHuLDsnhBInhBInhBInhBInhBInhBrqW2PSLWee+XJ1/pfNTw50/X3vrek5O/LFxQNdO5m3xoQZRpwQSpwQSpwQSpwQSpwQSpwQaqiPjDHzzFnymZ6zr659faj3PvjsfT1nK8qJod47kZ0TQokTQokTQokTQokTQokTQokTQjnn5CoXvv6FnrMXlv9qGleCnRNCiRNCiRNCiRNCiRNCiRNCiRNCOeecZZp586rz+x46NrR7H/9wbnV+8x//M7R7z0R2TgglTgglTgglTgglTgglTgglTgjlnHOWefcbt1fne5YO75nNh/fuqs6XHZ99701bY+eEUOKEUOKEUOKEUOKEUOKEUI5SZpl3Nl2qzsdK0/e1f/3+rdX5sl86Kvkk7JwQSpwQSpwQSpwQSpwQSpwQSpwQyjlnxzR3rqvOD91zsDqfLG3f955s/Vk/lXw1IZQ4IZQ4IZQ4IZQ4IZQ4IZQ4IZRzzo55Y1f9v/i7a96Vod37wJsbqvPl5fTQ7t1Fdk4IJU4IJU4IJU4IJU4IJU4IJU4I5ZyzY36z+dDI7j3vhSUju3cX2TkhlDghlDghlDghlDghlDghlKMUrtu+99ZU55/93Znq/PJULmYWsHNCKHFCKHFCKHFCKHFCKHFCKHFCKHFCKHFCKHFCKHFCKHFCKHFCKHFCKHFCKM9zct0eWPxqdf78pi3V+YLD56dyOZ1n54RQ4oRQ4oRQ4oRQ4oRQ4oRQ4oRQzjm5bt89t606X3D45DStZHawc0IocUIocUIocUIocUIocUIocUIo55xctwt7V1bnC8o/p2kls4OdE0KJE0KJE0KJE0KJE0KJE0I5SumYh5/6VnV+eWHb97VXn363Or/S95W5FjsnhBInhBInhBInhBInhBInhBInhHLO2TErfnRiaNd2jjm97JwQSpwQSpwQSpwQSpwQSpwQSpwQqmnb/p/vA4bHzgmhxAmhxAmhxAmhxAmhxAmh/gt+StniAoP4XwAAAABJRU5ErkJggg==
"
>
</div>

</div>

<div class="output_area">



<div class="output_png output_subarea ">
<img src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAOcAAAD3CAYAAADmIkO7AAAABHNCSVQICAgIfAhkiAAAAAlwSFlzAAALEgAACxIB0t1+/AAAADh0RVh0U29mdHdhcmUAbWF0cGxvdGxpYiB2ZXJzaW9uMy4xLjAsIGh0dHA6Ly9tYXRwbG90bGliLm9yZy+17YcXAAAGwUlEQVR4nO3dUaifdR3H8d9zzk7HOFunWW2xzApq4SCJVtLsRggrjIKwGSHMQRJiBBlRd1FEUXQhw13UnWYEsjKCLtLNIrRQ2yxWC9FkXRipsXK2uek85+kqaLHne+r8Pef/Of/zesFg7Lvn+f/YeO839tvznK7v+wbkmRr3AoALEyeEEieEEieEEieEEieEEieEEucE6Lru1H99W+i67rZxr4vRbBj3Ahhd3/cb//39ruvmWmtPt9YOjG9FvBzsnJPn4621Z1pr9497IYxGnJPnhtba93r/L3PN6/weTo6u6y5trR1vrb217/vj414Po7FzTpY9rbUHhDkZxDlZ9rTW7hj3Inh5+GvthOi67srW2sHW2uv7vv/nuNfD6Oyck+OG1trdwpwcdk4IZeeEUOKEUOKEUOKEUOV/fL96ard/LYIVdnDxQHehH7dzQihxQihxQihxQihxQihxQihxQihxQihxQihxQihxQihxQihxQihxQihxQihxQihxQihxQihxQihxQihxQihxQihxQihxQihxQihxQihxQihxQihxQihxQihxQihxQihxQihxQihxQihxQihxQihxQihxQihxQihxQihxQihxQihxQihxQihxQihxQihxQihxQihxQihxQihxQihxQqgN417AejS9efPgrLtotrz2zDsuKefHP1b/ebvr8sfL+Z1vvm9wNt3V937/Hz9azp8+WK/9Dd/6dTlfb+ycEEqcEEqcEEqcEEqcEEqcEEqcEGrNnnNOzc3VP+Ftb1r2vR+9ub73zKYXl33v1lr70jvvGZztedVfRrr3qBarWb9QXvuzy35czm+Zv7KcP7F/+Nd98fTp8tpJZOeEUOKEUOKEUOKEUOKEUOKEUOKEUGv2nPPE7svL+a++vn+VVpLl2yd2lPMT5+oz3LsP7xyczW4+W177+/fdXs5v3VY/r/nBXZ8enM0cOlJeO4nsnBBKnBBKnBBKnBBKnBBKnBBKnBBqzZ5zLs6M8bPLpx5bu/bx+v2to3jyR28p59vuPFbOF549Wc63t98MzpZ6hvZdN3+2nD/yudvK+fHrhveK7YfKSyeSnRNCiRNCiRNCiRNCiRNCiRNCiRNCrdlzzi131ed51zx648p9eN+X46kHfrdiH721/bWc12+WHc1S747d8Pxo9996yT9Gu8GEsXNCKHFCKHFCKHFCKHFCKHFCqDV7lLLw3HPlfOr+367SStaP6ddcXM4/cGP96sulnDj6usHZfPvTSPdei+ycEEqcEEqcEEqcEEqcEEqcEEqcEGrNnnOy+p667u3l/CdbRvuyi2889OJI108aOyeEEieEEieEEieEEieEEieEEieEcs7J/+zZXS+MdP3JxbPlfPpc/aUV1xs7J4QSJ4QSJ4QSJ4QSJ4QSJ4QSJ4Ryzsn5pqYHR/Pzo32Nv2uO7i3nm3/pXcP/yc4JocQJocQJocQJocQJocQJocQJoZxzcp5u547B2cPvvr289smXzpTzjfvml7OkdcvOCaHECaHECaHECaHECaHECaEcpXCevd//6bKv/eSxveV8/t7Dy773emTnhFDihFDihFDihFDihFDihFDihFDOOdeZx777nnJ+7cYjg7OlHgl75b5XL2tNXJidE0KJE0KJE0KJE0KJE0KJE0KJE0I555wwf7tpVzk/9uF95fzU4kuDs+u/+IXy2k33PFjO+f/YOSGUOCGUOCGUOCGUOCGUOCGUOCGUc84Jc+qq0+V8ppsu54+d6wdnm+5yjrma7JwQSpwQSpwQSpwQSpwQSpwQylHKGvPnr9WPhP3wvbcucYeZcnrLTZ8ZnL2i+RJ+q8nOCaHECaHECaHECaHECaHECaHECaGcc4Y5+5Eryvkd1+8v55fN1OeYD7/QlfPZnx8dnA0/TMZKsHNCKHFCKHFCKHFCKHFCKHFCKHFCKOecYzC9Y/vg7Bv7vlNeu3O2vvcnnvhQOX/+81vLeX/uD/UHsGrsnBBKnBBKnBBKnBBKnBBKnBBKnBDKOecKmJqbK+dPfXP4mcorZuunJn9x5qJyfvKrl5bzDYePlHNy2DkhlDghlDghlDghlDghlDghlDghlHPOFTC15bXl/KGdP1j2vb/8lU+V8/n7Hlz2vcli54RQ4oRQ4oRQ4oRQ4oRQ4oRQjlJWwDNXbVv2tfeeqR83u/iRv5fzhWV/MmnsnBBKnBBKnBBKnBBKnBBKnBBKnBCq6/vhVzFePbW7fk8jMLKDiwcu+K5UOyeEEieEEieEEieEEieEEieEEieEKs85gfGxc0IocUIocUIocUIocUIocUKofwFzROlrBoA/GgAAAABJRU5ErkJggg==
"
>
</div>

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">x</span><span class="p">,</span><span class="n">y</span> <span class="o">=</span> <span class="n">torch</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="n">x</span><span class="p">,</span><span class="mi">0</span><span class="p">),</span><span class="n">torch</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="n">y</span><span class="p">,</span><span class="mi">0</span><span class="p">)</span> <span class="c1">#Lose type of tensors (to emulate predictions)</span>
<span class="n">test_ne</span><span class="p">(</span><span class="nb">type</span><span class="p">(</span><span class="n">x</span><span class="p">),</span> <span class="n">TensorImage</span><span class="p">)</span>
<span class="n">tdl</span><span class="o">.</span><span class="n">show_batch</span><span class="p">((</span><span class="n">x</span><span class="p">,</span><span class="n">y</span><span class="p">),</span> <span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">4</span><span class="p">,</span><span class="mi">4</span><span class="p">))</span> <span class="c1">#Check that types are put back by dl.</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">



<div class="output_png output_subarea ">
<img src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAOcAAAD3CAYAAADmIkO7AAAABHNCSVQICAgIfAhkiAAAAAlwSFlzAAALEgAACxIB0t1+/AAAADh0RVh0U29mdHdhcmUAbWF0cGxvdGxpYiB2ZXJzaW9uMy4xLjAsIGh0dHA6Ly9tYXRwbG90bGliLm9yZy+17YcXAAAHcUlEQVR4nO3db6jeZR3H8et39qfNmaN0VqJzgXMtZWqKpRU4aEUWPmhbRckZOVQSexBFPYmkoLD1IJ34px5oCSY0mP0x2Bx7kn9mZtEWWxaLpZQ1W6Xuj7Z2zq8H0YPV+V2nnfuc3Z9zn9cLBnK+/O7r4sz3LvHafe6mbdsC5Bnq9waAsYkTQokTQokTQokTQokTQokTQolzADRNc+i/fo00TXNHv/dFb2b3ewP0rm3bU//zz03TLCil7C+lbOrfjpgMTs7Bs6aU8kIp5dF+b4TeiHPwrCul3N/6e5nTXuP3cHA0TbO4lLKvlHJe27b7+r0feuPkHCzDpZTHhDkYxDlYhksp3+n3Jpgc/rN2QDRNc2UpZVsp5Y1t2x7s937onZNzcKwrpWwW5uBwckIoJyeEEieEEieEEieEqv7F91VDa/3fIphi20Y3NWN93ckJocQJocQJocQJocQJocQJocQJocQJocQJocQJocQJocQJocQJocQJocQJocQJocQJocQJocQJocQJocQJocQJocQJocQJocQJocQJocQJocQJocQJocQJocQJocQJocQJocQJocQJocQJocQJocQJocQJocQJocQJocQJocQJocQJocQJocQJocQJocQJocQJocQJocQJocQJocQJoWb3ewODaGjBgur8r2tXdM52fOXO6rO/PHqsOl+z5ebq/Kw3H6jOH1+xuXP2+f0XV5/93pOXV+dT6bV76/8qn3X7U9V5e6z+fe0HJyeEEieEEieEEieEEieEEieEEieEatq27RyuGlrbPZzBZi1fWp0P3X2oOn9o6cOTuR3+D9dcfW11Prrz1ydpJ/9r2+imZqyvOzkhlDghlDghlDghlDghlDghlDghlPdzjmHWokXV+erNj1bnw6f9cTK3c5zzH7mhOj/9sbk9vf6Z1z7bObvh7J9Un/3AKS/1tHYvdo/zPtfmlaMnaSeTx8kJocQJocQJocQJocQJocQJocQJoWbk+znHu8f8x4Pzq/Mtyx/qaf3RMto5u2rXR6vPvv6m+n3esX3d95S9mrXsvOr892vOrM533nTHZG7nOO/e+ZHqfOHVe6ds7V55PydMM+KEUOKEUOKEUOKEUOKEUOKEUDPy/ZyvXnJudb51+TendP1bD1zUOTvt/b+rPtvPT5F8/n31e8x71t81ZWs//uqc6nz+xtdN2dr94uSEUOKEUOKEUOKEUOKEUOKEUDPyKmXeH16uzt+750PV+SNv3VydX7RjXXW+5JP7K9O/VJ/tp5GVL1bnV7xmZMrW/uytN1bnp2/ZMWVr94uTE0KJE0KJE0KJE0KJE0KJE0KJE0LNyB+NOZ5mdv36d+jUBdV5e/Sf1fnokSMnvKdJMzSrOt57/4rO2Z6V36q/dI9/1i/bfn3n7PzrdlWfbY/18810vfGjMWGaESeEEieEEieEEieEEieEEieEmpHv5xzPeHdmIy++dJJ2cuKG5s2rzp+/8W3V+TMrax/TV/+zvPbRhqWU8qUXLq3Olw7/onM2Ey/cnZwQSpwQSpwQSpwQSpwQSpwQSpwQyj3ngDnynu73Y5ZSytOfq91j9uYHh8+ozn9+ibPgRPhuQShxQihxQihxQihxQihxQihxQij3nNNMc+kF1fmBTxyesrW3v3JKdX7vx68Z5xV+NXmbmQGcnBBKnBBKnBBKnBBKnBBKnBDKVUqYoQX1jxdcuPFP1fmPlmzraf0fH1nYObtreHX12eZnO3tam+M5OSGUOCGUOCGUOCGUOCGUOCGUOCGUe84+aGZ3f9v//N1zqs/+cMkDk72d43zj0x/rnM3b8dSUrs3xnJwQSpwQSpwQSpwQSpwQSpwQSpwQyj1nHzz7hcs7Z7su6+0j+sb78ZWfuXd9dX7O1qc7Z+2EdsREOTkhlDghlDghlDghlDghlDghlDghlHvOKfDcLVdW57uu7+0us+bb+99ZnZ/91Seqc3eZOZycEEqcEEqcEEqcEEqcEEqcEMpVygQcXv326vzh6zaM8wrzJ7z2xU8OV+fnfvHYOK/wtwmvzcnl5IRQ4oRQ4oRQ4oRQ4oRQ4oRQ4oRQ7jnHcOjD76jO795wW3W+ePbE7zHve7n+EYCLbxmpzkd2/2bCa5PFyQmhxAmhxAmhxAmhxAmhxAmhxAmhZuQ9Z3PZhdX5nV+7vTpfPmdOT+s/ePANnbPvr35X9dnRPc/0tDbTh5MTQokTQokTQokTQokTQokTQokTQs3Ie87ffmpudX7B3N6+LQ8cfFN1vvG21Z2zRXt29LQ2g8PJCaHECaHECaHECaHECaHECaHECaEG9p7z7+uu6Jxtv+rr4zw98Z87W0opX/7pB6vzpfe4y2R8Tk4IJU4IJU4IJU4IJU4IJU4INbBXKWc8sb9ztvXwsuqz6xc+V51feN/N1flbNuyuzusf4gf/5uSEUOKEUOKEUOKEUOKEUOKEUOKEUE3btp3DVUNru4fApNg2uqkZ6+tOTgglTgglTgglTgglTgglTgglTghVvecE+sfJCaHECaHECaHECaHECaHECaH+BfC2ISxVaokHAAAAAElFTkSuQmCC
"
>
</div>

</div>

<div class="output_area">



<div class="output_png output_subarea ">
<img src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAOcAAAD3CAYAAADmIkO7AAAABHNCSVQICAgIfAhkiAAAAAlwSFlzAAALEgAACxIB0t1+/AAAADh0RVh0U29mdHdhcmUAbWF0cGxvdGxpYiB2ZXJzaW9uMy4xLjAsIGh0dHA6Ly9tYXRwbG90bGliLm9yZy+17YcXAAAGaElEQVR4nO3dX8iecxzH8d/1PNv8/xfDgZTYbBMrkoYTMgdyIG2UsglTpEQO/DlBcWhJijjBEZNSSO1AIvMvpmSGmtFiGLNpiOe5HFHTc/+W+3ru3Z/d9+tVq3V/n/u6fm29+639nut+mrZtC5BnYtgLAGYmTgglTgglTgglTgglTgglTgglzhHQNM2v//k11TTNo8NeF93MGfYC6K5t28P/+X3TNIeVUraXUtYNb0XMBjvn6FlRSvm+lPLmsBdCN+IcPatLKc+0vi/zgNf4OxwdTdOcXErZUko5rW3bLcNeD93YOUfLqlLKW8IcDeIcLatKKU8PexHMDv+sHRFN05xfSllfSjmxbdvdw14P3dk5R8fqUsqLwhwddk4IZeeEUOKEUOKEUOKEUNVvfF8+sdL/FsGArZ9e18z0up0TQokTQokTQokTQokTQokTQokTQokTQokTQokTQokTQokTQokTQokTQokTQokTQokTQokTQokTQokTQokTQokTQokTQokTQokTQokTQokTQokTQokTQokTQokTQokTQokTQokTQokTQokTQokTQokTQokTQokTQokTQokTQokTQokTQokTQokTQokTQokTQokTQokTQokTQokTQokTQs0Z9gKGYfL006rzV19/odP1p9rp6vzN33v/sV//8k2d7t3Vosd39Jy1W7dV3zv922/1i7dtP0saW3ZOCCVOCCVOCCVOCCVOCCVOCCVOCDWW55w/XDC/Ov95ak91fvjEQZ3uf8HBf/acbV7xWKdrd7ai/7cueeOG6nzBfbur86kvv+o9nJ7qY0UHNjsnhBInhBInhBInhBInhBInhBInhGrayjN2yydWjuUDeDvWLKvOn7jnkYHd+/bPr67O1y58rtP1j5jofcZaSimnzDm40/W7uOLCK3vO/tqydT+uZP9aP72umel1OyeEEieEEieEEieEEieEEieEEieEcs45ZiaXLKzON915ZM/Zxksfrb730GZeX2v6h3POvdk5IZQ4IZQ4IZQ4IZQ4IZQ4IZQ4IdRYfm7tOJv69PPq/NRnz+4523rxjMdx/1o8t68l0YOdE0KJE0KJE0KJE0KJE0KJE0I5Shkzk0cfVZ1/c37vj8ZcPLfbWcmXf/5R/4K/xu/H/NXYOSGUOCGUOCGUOCGUOCGUOCGUOCGUc84x89Pli6vzj2+pf/xlF9fffUd1fuQ37wzs3gciOyeEEieEEieEEieEEieEEieEEieEcs45YiaPO7b+Bdf8OLB7r/7qkur8mFc+rc49zbk3OyeEEieEEieEEieEEieEEieEEieEcs45YrZde3p1/sHSwT2v+c5HC6vzBbveHdi9R5GdE0KJE0KJE0KJE0KJE0KJE0KJE0I55zzA7Fy1rDp/9raH93GF/n/G5tINq6vzRfdsqs49r/n/2DkhlDghlDghlDghlDghlDghlKOUMO2ypdX5kw+src4Xz+3/qKSUUs56+7qes1PWfF1979SuXZ3uzd7snBBKnBBKnBBKnBBKnBBKnBBKnBDKOecQTM6f33O25/5fqu/teo5567YLq/PaWebUzvramF12TgglTgglTgglTgglTgglTgglTgjlnHMINq89qefsszOe6nTtDX9MVuebHjyzOj9k53ud7s/ssXNCKHFCKHFCKHFCKHFCKHFCKHFCKOecA1B7XrOUUq5csnFg977jwZur82Nf2jCwezO77JwQSpwQSpwQSpwQSpwQSpwQylHKAHx71YLq/KUTXuv72nd9d251Pv/5T6rz6b7vzP5m54RQ4oRQ4oRQ4oRQ4oRQ4oRQ4oRQzjn7sK9Hwi65of/Hsvb10ZYf3ntOdT5v9/t935ssdk4IJU4IJU4IJU4IJU4IJU4IJU4I5ZyzD9MnH1+dP9Thec3nd5xXnc97zTnmuLBzQihxQihxQihxQihxQihxQihxQijnnGFe+fjM6nxh+WA/rYRhs3NCKHFCKHFCKHFCKHFCKHFCKHFCKOecYZo99c+tZXzYOSGUOCGUOCGUOCGUOCGUOCGUo5Q+TG7fWZ0vev3G6vyzi57qObts2cbqe7+oThkldk4IJU4IJU4IJU4IJU4IJU4IJU4I1bRt23O4fGJl7yEwK9ZPr2tmet3OCaHECaHECaHECaHECaHECaHECaGq55zA8Ng5IZQ4IZQ4IZQ4IZQ4IZQ4IdTfjyzj9eqzYKoAAAAASUVORK5CYII=
"
>
</div>

</div>

<div class="output_area">



<div class="output_png output_subarea ">
<img src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAOcAAAD3CAYAAADmIkO7AAAABHNCSVQICAgIfAhkiAAAAAlwSFlzAAALEgAACxIB0t1+/AAAADh0RVh0U29mdHdhcmUAbWF0cGxvdGxpYiB2ZXJzaW9uMy4xLjAsIGh0dHA6Ly9tYXRwbG90bGliLm9yZy+17YcXAAAGf0lEQVR4nO3dX6jXdx3H8c/3OFPyT+7CnDQ38t9FS8qNQVOZu5iwsBtJYSPmgaASajF2k2OEMCqKbjIDazqYu9gYR0a7WYkEQeoQNoyxJWOgVqyhbayRiw31fLvaheHvk/v9zu/8Xud7Hg8Q5Lz9fb+fc+TpR/yc78+mbdsC5Bkb9QKAaxMnhBInhBInhBInhBInhBInhBJnBzRNc/F/flxpmmbfqNfFYG4Y9QIYXNu2Cz/+edM0C0op50spE6NbEVPBztk920spF0opfxr1QhiMOLtnvJTydOv7Mme8xu9hdzRNc0sp5WwpZXXbtmdHvR4GY+fslp2llGPC7AZxdsvOUsqhUS+CqeGvtR3RNM2GUsrRUspNbdv+e9TrYXB2zu4YL6U8L8zusHNCKDsnhBInhBInhBInhKp+4/uWsR3+tQiG7OjkRHOtj9s5IZQ4IZQ4IZQ4IZQ4IZQ4IZQ4IZQ4IZQ4IZQ4IZQ4IZQ4IZQ4IZQ4IZQ4IZQ4IZQ4IZQ4IZQ4IZQ4IZQ4IZQ4IZQ4IZQ4IZQ4IZQ4IZQ4IZQ4IZQ4IZQ4IZQ4IZQ4IZQ4IZQ4IZQ4IZQ4IZQ4IZQ4IZQ4IZQ4IZQ4IZQ4IZQ4IZQ4IZQ4IZQ4IZQ4IZQ4IZQ4IZQ4IZQ4IZQ4IZQ4IdQNo14AVzvzs7vqv6CdnnXMNCt3vzTqJUw5OyeEEieEEieEEieEEieEEieEEieEij3nfPuRDdX5D77zXHX+lfl/7Tl78eJt1dfuf3ZrdX5pUf2w8ff3/7w6r1k198/1e7dX+r52l31t9x2jXsKUs3NCKHFCKHFCKHFCKHFCKHFCKHFCqKZte5/ZbRnbMdDTg3//Ye+zyl+MH6i+dtP8D6rzuc2cvtY0HS5OflSdbzz57Z6zHWtOVV87MbG5Ov9wdf3e8xfW54P4yZd+W51v/fT7fV97z4X11fkr62fuPnN0cqK51sdn7mcEHSdOCCVOCCVOCCVOCCVOCCVOCDXU5zmf+ubenrP1n/p/fy4Mdo45fu7enrOX3lhVfe2yP9S/LD99/In6fPvO6nzFqdd6zl7+3K311759sjovk6N73vOxR+uf99bv7ev72oePbKzOP1+8by0wTcQJocQJocQJocQJocQJocQJoYZ6zvngM9/vOVt395sDXfut/aur8xtfPN1ztvZfL1dfO7ZoUXX+47+N119/qv5MZs3lt/7R92uHbc7SpdX5pm39f96llPJRe6nnbGHvtyHuLDsnhBInhBInhBInhBInhBInhBrqW2PSLWee+XJ1/pfNTw50/X3vrek5O/LFxQNdO5m3xoQZRpwQSpwQSpwQSpwQSpwQSpwQaqiPjDHzzFnymZ6zr659faj3PvjsfT1nK8qJod47kZ0TQokTQokTQokTQokTQokTQokTQjnn5CoXvv6FnrMXlv9qGleCnRNCiRNCiRNCiRNCiRNCiRNCiRNCOeecZZp586rz+x46NrR7H/9wbnV+8x//M7R7z0R2TgglTgglTgglTgglTgglTgglTgjlnHOWefcbt1fne5YO75nNh/fuqs6XHZ99701bY+eEUOKEUOKEUOKEUOKEUOKEUI5SZpl3Nl2qzsdK0/e1f/3+rdX5sl86Kvkk7JwQSpwQSpwQSpwQSpwQSpwQSpwQyjlnxzR3rqvOD91zsDqfLG3f955s/Vk/lXw1IZQ4IZQ4IZQ4IZQ4IZQ4IZQ4IZRzzo55Y1f9v/i7a96Vod37wJsbqvPl5fTQ7t1Fdk4IJU4IJU4IJU4IJU4IJU4IJU4I5ZyzY36z+dDI7j3vhSUju3cX2TkhlDghlDghlDghlDghlDghlKMUrtu+99ZU55/93Znq/PJULmYWsHNCKHFCKHFCKHFCKHFCKHFCKHFCKHFCKHFCKHFCKHFCKHFCKHFCKHFCKHFCKM9zct0eWPxqdf78pi3V+YLD56dyOZ1n54RQ4oRQ4oRQ4oRQ4oRQ4oRQ4oRQzjm5bt89t606X3D45DStZHawc0IocUIocUIocUIocUIocUIocUIo55xctwt7V1bnC8o/p2kls4OdE0KJE0KJE0KJE0KJE0KJE0I5SumYh5/6VnV+eWHb97VXn363Or/S95W5FjsnhBInhBInhBInhBInhBInhBInhHLO2TErfnRiaNd2jjm97JwQSpwQSpwQSpwQSpwQSpwQSpwQqmnb/p/vA4bHzgmhxAmhxAmhxAmhxAmhxAmh/gt+StniAoP4XwAAAABJRU5ErkJggg==
"
>
</div>

</div>

<div class="output_area">



<div class="output_png output_subarea ">
<img src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAOcAAAD3CAYAAADmIkO7AAAABHNCSVQICAgIfAhkiAAAAAlwSFlzAAALEgAACxIB0t1+/AAAADh0RVh0U29mdHdhcmUAbWF0cGxvdGxpYiB2ZXJzaW9uMy4xLjAsIGh0dHA6Ly9tYXRwbG90bGliLm9yZy+17YcXAAAGwUlEQVR4nO3dUaifdR3H8d9zzk7HOFunWW2xzApq4SCJVtLsRggrjIKwGSHMQRJiBBlRd1FEUXQhw13UnWYEsjKCLtLNIrRQ2yxWC9FkXRipsXK2uek85+kqaLHne+r8Pef/Of/zesFg7Lvn+f/YeO839tvznK7v+wbkmRr3AoALEyeEEieEEieEEieEEieEEieEEucE6Lru1H99W+i67rZxr4vRbBj3Ahhd3/cb//39ruvmWmtPt9YOjG9FvBzsnJPn4621Z1pr9497IYxGnJPnhtba93r/L3PN6/weTo6u6y5trR1vrb217/vj414Po7FzTpY9rbUHhDkZxDlZ9rTW7hj3Inh5+GvthOi67srW2sHW2uv7vv/nuNfD6Oyck+OG1trdwpwcdk4IZeeEUOKEUOKEUOKEUOV/fL96ard/LYIVdnDxQHehH7dzQihxQihxQihxQihxQihxQihxQihxQihxQihxQihxQihxQihxQihxQihxQihxQihxQihxQihxQihxQihxQihxQihxQihxQihxQihxQihxQihxQihxQihxQihxQihxQihxQihxQihxQihxQihxQihxQihxQihxQihxQihxQihxQihxQihxQihxQihxQihxQihxQihxQihxQihxQihxQqgN417AejS9efPgrLtotrz2zDsuKefHP1b/ebvr8sfL+Z1vvm9wNt3V937/Hz9azp8+WK/9Dd/6dTlfb+ycEEqcEEqcEEqcEEqcEEqcEEqcEGrNnnNOzc3VP+Ftb1r2vR+9ub73zKYXl33v1lr70jvvGZztedVfRrr3qBarWb9QXvuzy35czm+Zv7KcP7F/+Nd98fTp8tpJZOeEUOKEUOKEUOKEUOKEUOKEUOKEUGv2nPPE7svL+a++vn+VVpLl2yd2lPMT5+oz3LsP7xyczW4+W177+/fdXs5v3VY/r/nBXZ8enM0cOlJeO4nsnBBKnBBKnBBKnBBKnBBKnBBKnBBqzZ5zLs6M8bPLpx5bu/bx+v2to3jyR28p59vuPFbOF549Wc63t98MzpZ6hvZdN3+2nD/yudvK+fHrhveK7YfKSyeSnRNCiRNCiRNCiRNCiRNCiRNCiRNCrdlzzi131ed51zx648p9eN+X46kHfrdiH721/bWc12+WHc1S747d8Pxo9996yT9Gu8GEsXNCKHFCKHFCKHFCKHFCKHFCqDV7lLLw3HPlfOr+367SStaP6ddcXM4/cGP96sulnDj6usHZfPvTSPdei+ycEEqcEEqcEEqcEEqcEEqcEEqcEGrNnnOy+p667u3l/CdbRvuyi2889OJI108aOyeEEieEEieEEieEEieEEieEEieEcs7J/+zZXS+MdP3JxbPlfPpc/aUV1xs7J4QSJ4QSJ4QSJ4QSJ4QSJ4QSJ4Ryzsn5pqYHR/Pzo32Nv2uO7i3nm3/pXcP/yc4JocQJocQJocQJocQJocQJocQJoZxzcp5u547B2cPvvr289smXzpTzjfvml7OkdcvOCaHECaHECaHECaHECaHECaEcpXCevd//6bKv/eSxveV8/t7Dy773emTnhFDihFDihFDihFDihFDihFDihFDOOdeZx777nnJ+7cYjg7OlHgl75b5XL2tNXJidE0KJE0KJE0KJE0KJE0KJE0KJE0I555wwf7tpVzk/9uF95fzU4kuDs+u/+IXy2k33PFjO+f/YOSGUOCGUOCGUOCGUOCGUOCGUOCGUc84Jc+qq0+V8ppsu54+d6wdnm+5yjrma7JwQSpwQSpwQSpwQSpwQSpwQylHKGvPnr9WPhP3wvbcucYeZcnrLTZ8ZnL2i+RJ+q8nOCaHECaHECaHECaHECaHECaHECaGcc4Y5+5Eryvkd1+8v55fN1OeYD7/QlfPZnx8dnA0/TMZKsHNCKHFCKHFCKHFCKHFCKHFCKHFCKOecYzC9Y/vg7Bv7vlNeu3O2vvcnnvhQOX/+81vLeX/uD/UHsGrsnBBKnBBKnBBKnBBKnBBKnBBKnBDKOecKmJqbK+dPfXP4mcorZuunJn9x5qJyfvKrl5bzDYePlHNy2DkhlDghlDghlDghlDghlDghlDghlHPOFTC15bXl/KGdP1j2vb/8lU+V8/n7Hlz2vcli54RQ4oRQ4oRQ4oRQ4oRQ4oRQjlJWwDNXbVv2tfeeqR83u/iRv5fzhWV/MmnsnBBKnBBKnBBKnBBKnBBKnBBKnBCq6/vhVzFePbW7fk8jMLKDiwcu+K5UOyeEEieEEieEEieEEieEEieEEieEKs85gfGxc0IocUIocUIocUIocUIocUKofwFzROlrBoA/GgAAAABJRU5ErkJggg==
"
>
</div>

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="c1">#TODO: make the above check a proper test</span>
</pre></div>

    </div>
</div>
</div>

</div>
</div>
 

